/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={6486:(e,t,n)=>{var r,o;void 0===(o="function"==typeof(r=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?a(e):t}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=i(e);if(t){var o=i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}var d=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return r(t,[{key:"addEventListener",value:function(e,t,n){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:n})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,o=n.length;r<o;r++)if(n[r].callback===t)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),n=0,r=t.length;n<r;n++){var o=t[n];try{o.callback.call(this,e)}catch(e){Promise.resolve().then((function(){throw e}))}o.options&&o.options.once&&this.removeEventListener(e.type,o.callback)}return!e.defaultPrevented}}}]),t}(),f=function(t){o(s,t);var n=u(s);function s(){var t;return e(this,s),(t=n.call(this)).listeners||d.call(a(t)),Object.defineProperty(a(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(a(t),"onabort",{value:null,writable:!0,configurable:!0}),t}return r(s,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),l(i(s.prototype),"dispatchEvent",this).call(this,e)}}]),s}(d),h=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new f,writable:!0,configurable:!0})}return r(t,[{key:"abort",value:function(){var e;try{e=new Event("abort")}catch(t){"undefined"!=typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(h.prototype[Symbol.toStringTag]="AbortController",f.prototype[Symbol.toStringTag]="AbortSignal"),function(e){(function(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController})(e)&&(e.AbortController=h,e.AbortSignal=f)}("undefined"!=typeof self?self:n.g)})?r.call(t,n,t,e):r)||(e.exports=o)},3099:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},1223:(e,t,n)=>{var r=n(5112),o=n(30),i=n(3070),s=r("unscopables"),a=Array.prototype;null==a[s]&&i.f(a,s,{configurable:!0,value:o(null)}),e.exports=function(e){a[s][e]=!0}},9670:(e,t,n)=>{var r=n(111);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},1318:(e,t,n)=>{var r=n(5656),o=n(7466),i=n(1400),s=function(e){return function(t,n,s){var a,c=r(t),u=o(c.length),l=i(s,u);if(e&&n!=n){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},5417:(e,t,n)=>{var r=n(111),o=n(3157),i=n(5112)("species");e.exports=function(e,t){var n;return o(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!o(n.prototype)?r(n)&&null===(n=n[i])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},4326:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},9920:(e,t,n)=>{var r=n(6656),o=n(3887),i=n(1236),s=n(3070);e.exports=function(e,t){for(var n=o(t),a=s.f,c=i.f,u=0;u<n.length;u++){var l=n[u];r(e,l)||a(e,l,c(t,l))}}},8880:(e,t,n)=>{var r=n(9781),o=n(3070),i=n(9114);e.exports=r?function(e,t,n){return o.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},9114:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},9781:(e,t,n)=>{var r=n(7293);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},317:(e,t,n)=>{var r=n(7854),o=n(111),i=r.document,s=o(i)&&o(i.createElement);e.exports=function(e){return s?i.createElement(e):{}}},748:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:(e,t,n)=>{var r=n(7854),o=n(1236).f,i=n(8880),s=n(1320),a=n(3505),c=n(9920),u=n(4705);e.exports=function(e,t){var n,l,d,f,h,p=e.target,g=e.global,m=e.stat;if(n=g?r:m?r[p]||a(p,{}):(r[p]||{}).prototype)for(l in t){if(f=t[l],d=e.noTargetGet?(h=o(n,l))&&h.value:n[l],!u(g?l:p+(m?".":"#")+l,e.forced)&&void 0!==d){if(typeof f==typeof d)continue;c(f,d)}(e.sham||d&&d.sham)&&i(f,"sham",!0),s(n,l,f,e)}}},7293:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},6790:(e,t,n)=>{"use strict";var r=n(3157),o=n(7466),i=n(9974),s=function(e,t,n,a,c,u,l,d){for(var f,h=c,p=0,g=!!l&&i(l,d,3);p<a;){if(p in n){if(f=g?g(n[p],p,t):n[p],u>0&&r(f))h=s(e,t,f,o(f.length),h,u-1)-1;else{if(h>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[h]=f}h++}p++}return h};e.exports=s},9974:(e,t,n)=>{var r=n(3099);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},5005:(e,t,n)=>{var r=n(857),o=n(7854),i=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?i(r[e])||i(o[e]):r[e]&&r[e][t]||o[e]&&o[e][t]}},7854:(e,t,n)=>{var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},6656:e=>{var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},3501:e=>{e.exports={}},490:(e,t,n)=>{var r=n(5005);e.exports=r("document","documentElement")},4664:(e,t,n)=>{var r=n(9781),o=n(7293),i=n(317);e.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},8361:(e,t,n)=>{var r=n(7293),o=n(4326),i="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?i.call(e,""):Object(e)}:Object},2788:(e,t,n)=>{var r=n(5465),o=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return o.call(e)}),e.exports=r.inspectSource},9909:(e,t,n)=>{var r,o,i,s=n(8536),a=n(7854),c=n(111),u=n(8880),l=n(6656),d=n(5465),f=n(6200),h=n(3501),p=a.WeakMap;if(s){var g=d.state||(d.state=new p),m=g.get,y=g.has,b=g.set;r=function(e,t){return t.facade=e,b.call(g,e,t),t},o=function(e){return m.call(g,e)||{}},i=function(e){return y.call(g,e)}}else{var v=f("state");h[v]=!0,r=function(e,t){return t.facade=e,u(e,v,t),t},o=function(e){return l(e,v)?e[v]:{}},i=function(e){return l(e,v)}}e.exports={set:r,get:o,has:i,enforce:function(e){return i(e)?o(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=o(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},3157:(e,t,n)=>{var r=n(4326);e.exports=Array.isArray||function(e){return"Array"==r(e)}},4705:(e,t,n)=>{var r=n(7293),o=/#|\.prototype\./,i=function(e,t){var n=a[s(e)];return n==u||n!=c&&("function"==typeof t?r(t):!!t)},s=i.normalize=function(e){return String(e).replace(o,".").toLowerCase()},a=i.data={},c=i.NATIVE="N",u=i.POLYFILL="P";e.exports=i},111:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},1913:e=>{e.exports=!1},133:(e,t,n)=>{var r=n(7293);e.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},8536:(e,t,n)=>{var r=n(7854),o=n(2788),i=r.WeakMap;e.exports="function"==typeof i&&/native code/.test(o(i))},30:(e,t,n)=>{var r,o=n(9670),i=n(6048),s=n(748),a=n(3501),c=n(490),u=n(317),l=n(6200)("IE_PROTO"),d=function(){},f=function(e){return"<script>"+e+"<\/script>"},h=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;h=r?function(e){e.write(f("")),e.close();var t=e.parentWindow.Object;return e=null,t}(r):((t=u("iframe")).style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(f("document.F=Object")),e.close(),e.F);for(var n=s.length;n--;)delete h.prototype[s[n]];return h()};a[l]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(d.prototype=o(e),n=new d,d.prototype=null,n[l]=e):n=h(),void 0===t?n:i(n,t)}},6048:(e,t,n)=>{var r=n(9781),o=n(3070),i=n(9670),s=n(1956);e.exports=r?Object.defineProperties:function(e,t){i(e);for(var n,r=s(t),a=r.length,c=0;a>c;)o.f(e,n=r[c++],t[n]);return e}},3070:(e,t,n)=>{var r=n(9781),o=n(4664),i=n(9670),s=n(7593),a=Object.defineProperty;t.f=r?a:function(e,t,n){if(i(e),t=s(t,!0),i(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},1236:(e,t,n)=>{var r=n(9781),o=n(5296),i=n(9114),s=n(5656),a=n(7593),c=n(6656),u=n(4664),l=Object.getOwnPropertyDescriptor;t.f=r?l:function(e,t){if(e=s(e),t=a(t,!0),u)try{return l(e,t)}catch(e){}if(c(e,t))return i(!o.f.call(e,t),e[t])}},8006:(e,t,n)=>{var r=n(6324),o=n(748).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},5181:(e,t)=>{t.f=Object.getOwnPropertySymbols},6324:(e,t,n)=>{var r=n(6656),o=n(5656),i=n(1318).indexOf,s=n(3501);e.exports=function(e,t){var n,a=o(e),c=0,u=[];for(n in a)!r(s,n)&&r(a,n)&&u.push(n);for(;t.length>c;)r(a,n=t[c++])&&(~i(u,n)||u.push(n));return u}},1956:(e,t,n)=>{var r=n(6324),o=n(748);e.exports=Object.keys||function(e){return r(e,o)}},5296:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},3887:(e,t,n)=>{var r=n(5005),o=n(8006),i=n(5181),s=n(9670);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(s(e)),n=i.f;return n?t.concat(n(e)):t}},857:(e,t,n)=>{var r=n(7854);e.exports=r},1320:(e,t,n)=>{var r=n(7854),o=n(8880),i=n(6656),s=n(3505),a=n(2788),c=n(9909),u=c.get,l=c.enforce,d=String(String).split("String");(e.exports=function(e,t,n,a){var c,u=!!a&&!!a.unsafe,f=!!a&&!!a.enumerable,h=!!a&&!!a.noTargetGet;"function"==typeof n&&("string"!=typeof t||i(n,"name")||o(n,"name",t),(c=l(n)).source||(c.source=d.join("string"==typeof t?t:""))),e!==r?(u?!h&&e[t]&&(f=!0):delete e[t],f?e[t]=n:o(e,t,n)):f?e[t]=n:s(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||a(this)}))},4488:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},3505:(e,t,n)=>{var r=n(7854),o=n(8880);e.exports=function(e,t){try{o(r,e,t)}catch(n){r[e]=t}return t}},6200:(e,t,n)=>{var r=n(2309),o=n(9711),i=r("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},5465:(e,t,n)=>{var r=n(7854),o=n(3505),i="__core-js_shared__",s=r[i]||o(i,{});e.exports=s},2309:(e,t,n)=>{var r=n(1913),o=n(5465);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.8.3",mode:r?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},1400:(e,t,n)=>{var r=n(9958),o=Math.max,i=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):i(n,t)}},5656:(e,t,n)=>{var r=n(8361),o=n(4488);e.exports=function(e){return r(o(e))}},9958:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:t)(e)}},7466:(e,t,n)=>{var r=n(9958),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},7908:(e,t,n)=>{var r=n(4488);e.exports=function(e){return Object(r(e))}},7593:(e,t,n)=>{var r=n(111);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},9711:e=>{var t=0,n=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++t+n).toString(36)}},3307:(e,t,n)=>{var r=n(133);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5112:(e,t,n)=>{var r=n(7854),o=n(2309),i=n(6656),s=n(9711),a=n(133),c=n(3307),u=o("wks"),l=r.Symbol,d=c?l:l&&l.withoutSetter||s;e.exports=function(e){return i(u,e)||(a&&i(l,e)?u[e]=l[e]:u[e]=d("Symbol."+e)),u[e]}},4944:(e,t,n)=>{"use strict";var r=n(2109),o=n(6790),i=n(7908),s=n(7466),a=n(9958),c=n(5417);r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=i(this),n=s(t.length),r=c(t,0);return r.length=o(r,t,t,n,0,void 0===e?1:a(e)),r}})},3792:(e,t,n)=>{n(1223)("flat")},4098:function(e,t){var n=function(e){function t(){this.fetch=!1,this.DOMException=e.DOMException}return t.prototype=e,new t}("undefined"!=typeof self?self:this);!function(e){!function(t){var n="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,o="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function g(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:i&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&o&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e,t,n,r=h(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,n=p(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=u(e),t=l(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},f.prototype.delete=function(e){delete this.map[u(e)]},f.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},f.prototype.set=function(e,t){this.map[u(e)]=l(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),d(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),d(e)},r&&(f.prototype[Symbol.iterator]=f.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(e,t){var n,r,o=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(r=(n=t.method||this.method||"GET").toUpperCase(),b.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}})),t}function _(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},y.call(v.prototype),y.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var E=[301,302,303,307,308];_.redirect=function(e,t){if(-1===E.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function x(e,n){return new Promise((function(r,i){var s=new v(e,n);if(s.signal&&s.signal.aborted)return i(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}})),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;r(new _(o,n))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new t.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}x.polyfill=!0,e.fetch||(e.fetch=x,e.Headers=f,e.Request=v,e.Response=_),t.Headers=f,t.Request=v,t.Response=_,t.fetch=x}({})}(n),delete n.fetch.polyfill,(t=n.fetch).default=n.fetch,t.fetch=n.fetch,t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response,e.exports=t},9435:e=>{var t=1e3,n=60*t,r=60*n,o=24*r;function i(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,s){s=s||{};var a,c,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(i){var s=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===u&&isFinite(e))return s.long?(a=e,(c=Math.abs(a))>=o?i(a,c,o,"day"):c>=r?i(a,c,r,"hour"):c>=n?i(a,c,n,"minute"):c>=t?i(a,c,t,"second"):a+" ms"):function(e){var i=Math.abs(e);return i>=o?Math.round(e/o)+"d":i>=r?Math.round(e/r)+"h":i>=n?Math.round(e/n)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},1227:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(2447)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},2447:(e,t,n)=>{e.exports=function(e){function t(e){let n,o=null;function i(...e){if(!i.enabled)return;const r=i,o=Number(new Date),s=o-(n||o);r.diff=s,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";a++;const i=t.formatters[o];if("function"==typeof i){const t=e[a];n=i.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return i.namespace=e,i.useColors=t.useColors(),i.color=t.selectColor(e),i.extend=r,i.destroy=t.destroy,Object.defineProperty(i,"enabled",{enumerable:!0,configurable:!1,get:()=>null===o?t.enabled(e):o,set:e=>{o=e}}),"function"==typeof t.init&&t.init(i),i}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(9435),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},7529:e=>{var t=-1;function n(e,a,c,u){if(e===a)return e?[[0,e]]:[];if(null!=c){var l=function(e,t,n){var r="number"==typeof n?{index:n,length:0}:n.oldRange,o="number"==typeof n?null:n.newRange,i=e.length,s=t.length;if(0===r.length&&(null===o||0===o.length)){var a=r.index,c=e.slice(0,a),u=e.slice(a),l=o?o.index:null,f=a+s-i;if((null===l||l===f)&&!(f<0||f>s)){var h=t.slice(0,f);if((m=t.slice(f))===u){var p=Math.min(a,f);if((b=c.slice(0,p))===(w=h.slice(0,p)))return d(b,c.slice(p),h.slice(p),u)}}if(null===l||l===a){var g=a,m=(h=t.slice(0,g),t.slice(g));if(h===c){var y=Math.min(i-g,s-g);if((v=u.slice(u.length-y))===(_=m.slice(m.length-y)))return d(c,u.slice(0,u.length-y),m.slice(0,m.length-y),v)}}}if(r.length>0&&o&&0===o.length){var b=e.slice(0,r.index),v=e.slice(r.index+r.length);if(!(s<(p=b.length)+(y=v.length))){var w=t.slice(0,p),_=t.slice(s-y);if(b===w&&v===_)return d(b,e.slice(p,i-y),t.slice(p,s-y),v)}}return null}(e,a,c);if(l)return l}var f=o(e,a),h=e.substring(0,f);f=i(e=e.substring(f),a=a.substring(f));var p=e.substring(e.length-f),g=function(e,s){var a;if(!e)return[[1,s]];if(!s)return[[t,e]];var c=e.length>s.length?e:s,u=e.length>s.length?s:e,l=c.indexOf(u);if(-1!==l)return a=[[1,c.substring(0,l)],[0,u],[1,c.substring(l+u.length)]],e.length>s.length&&(a[0][0]=a[2][0]=t),a;if(1===u.length)return[[t,e],[1,s]];var d=function(e,t){var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;function s(e,t,n){for(var r,s,a,c,u=e.substring(n,n+Math.floor(e.length/4)),l=-1,d="";-1!==(l=t.indexOf(u,l+1));){var f=o(e.substring(n),t.substring(l)),h=i(e.substring(0,n),t.substring(0,l));d.length<h+f&&(d=t.substring(l-h,l)+t.substring(l,l+f),r=e.substring(0,n-h),s=e.substring(n+f),a=t.substring(0,l-h),c=t.substring(l+f))}return 2*d.length>=e.length?[r,s,a,c,d]:null}var a,c,u,l,d,f=s(n,r,Math.ceil(n.length/4)),h=s(n,r,Math.ceil(n.length/2));return f||h?(a=h?f&&f[4].length>h[4].length?f:h:f,e.length>t.length?(c=a[0],u=a[1],l=a[2],d=a[3]):(l=a[0],d=a[1],c=a[2],u=a[3]),[c,u,l,d,a[4]]):null}(e,s);if(d){var f=d[0],h=d[1],p=d[2],g=d[3],m=d[4],y=n(f,p),b=n(h,g);return y.concat([[0,m]],b)}return function(e,n){for(var o=e.length,i=n.length,s=Math.ceil((o+i)/2),a=s,c=2*s,u=new Array(c),l=new Array(c),d=0;d<c;d++)u[d]=-1,l[d]=-1;u[a+1]=0,l[a+1]=0;for(var f=o-i,h=f%2!=0,p=0,g=0,m=0,y=0,b=0;b<s;b++){for(var v=-b+p;v<=b-g;v+=2){for(var w=a+v,_=(S=v===-b||v!==b&&u[w-1]<u[w+1]?u[w+1]:u[w-1]+1)-v;S<o&&_<i&&e.charAt(S)===n.charAt(_);)S++,_++;if(u[w]=S,S>o)g+=2;else if(_>i)p+=2;else if(h&&(k=a+f-v)>=0&&k<c&&-1!==l[k]&&S>=(x=o-l[k]))return r(e,n,S,_)}for(var E=-b+m;E<=b-y;E+=2){for(var x,k=a+E,O=(x=E===-b||E!==b&&l[k-1]<l[k+1]?l[k+1]:l[k-1]+1)-E;x<o&&O<i&&e.charAt(o-x-1)===n.charAt(i-O-1);)x++,O++;if(l[k]=x,x>o)y+=2;else if(O>i)m+=2;else if(!h){var S;if((w=a+f-E)>=0&&w<c&&-1!==u[w])if(_=a+(S=u[w])-w,S>=(x=o-x))return r(e,n,S,_)}}}return[[t,e],[1,n]]}(e,s)}(e=e.substring(0,e.length-f),a=a.substring(0,a.length-f));return h&&g.unshift([0,h]),p&&g.push([0,p]),s(g,u),g}function r(e,t,r,o){var i=e.substring(0,r),s=t.substring(0,o),a=e.substring(r),c=t.substring(o),u=n(i,s),l=n(a,c);return u.concat(l)}function o(e,t){if(!e||!t||e.charAt(0)!==t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),o=r,i=0;n<o;)e.substring(i,o)==t.substring(i,o)?i=n=o:r=o,o=Math.floor((r-n)/2+n);return a(e.charCodeAt(o-1))&&o--,o}function i(e,t){if(!e||!t||e.slice(-1)!==t.slice(-1))return 0;for(var n=0,r=Math.min(e.length,t.length),o=r,i=0;n<o;)e.substring(e.length-o,e.length-i)==t.substring(t.length-o,t.length-i)?i=n=o:r=o,o=Math.floor((r-n)/2+n);return c(e.charCodeAt(e.length-o))&&o--,o}function s(e,n){e.push([0,""]);for(var r,a=0,c=0,d=0,f="",h="";a<e.length;)if(a<e.length-1&&!e[a][1])e.splice(a,1);else switch(e[a][0]){case 1:d++,h+=e[a][1],a++;break;case t:c++,f+=e[a][1],a++;break;case 0:var p=a-d-c-1;if(n){if(p>=0&&l(e[p][1])){var g=e[p][1].slice(-1);if(e[p][1]=e[p][1].slice(0,-1),f=g+f,h=g+h,!e[p][1]){e.splice(p,1),a--;var m=p-1;e[m]&&1===e[m][0]&&(d++,h=e[m][1]+h,m--),e[m]&&e[m][0]===t&&(c++,f=e[m][1]+f,m--),p=m}}u(e[a][1])&&(g=e[a][1].charAt(0),e[a][1]=e[a][1].slice(1),f+=g,h+=g)}if(a<e.length-1&&!e[a][1]){e.splice(a,1);break}if(f.length>0||h.length>0){f.length>0&&h.length>0&&(0!==(r=o(h,f))&&(p>=0?e[p][1]+=h.substring(0,r):(e.splice(0,0,[0,h.substring(0,r)]),a++),h=h.substring(r),f=f.substring(r)),0!==(r=i(h,f))&&(e[a][1]=h.substring(h.length-r)+e[a][1],h=h.substring(0,h.length-r),f=f.substring(0,f.length-r)));var y=d+c;0===f.length&&0===h.length?(e.splice(a-y,y),a-=y):0===f.length?(e.splice(a-y,y,[1,h]),a=a-y+1):0===h.length?(e.splice(a-y,y,[t,f]),a=a-y+1):(e.splice(a-y,y,[t,f],[1,h]),a=a-y+2)}0!==a&&0===e[a-1][0]?(e[a-1][1]+=e[a][1],e.splice(a,1)):a++,d=0,c=0,f="",h=""}""===e[e.length-1][1]&&e.pop();var b=!1;for(a=1;a<e.length-1;)0===e[a-1][0]&&0===e[a+1][0]&&(e[a][1].substring(e[a][1].length-e[a-1][1].length)===e[a-1][1]?(e[a][1]=e[a-1][1]+e[a][1].substring(0,e[a][1].length-e[a-1][1].length),e[a+1][1]=e[a-1][1]+e[a+1][1],e.splice(a-1,1),b=!0):e[a][1].substring(0,e[a+1][1].length)==e[a+1][1]&&(e[a-1][1]+=e[a+1][1],e[a][1]=e[a][1].substring(e[a+1][1].length)+e[a+1][1],e.splice(a+1,1),b=!0)),a++;b&&s(e,n)}function a(e){return e>=55296&&e<=56319}function c(e){return e>=56320&&e<=57343}function u(e){return c(e.charCodeAt(0))}function l(e){return a(e.charCodeAt(e.length-1))}function d(e,n,r,o){return l(e)||u(o)?null:function(e){for(var t=[],n=0;n<e.length;n++)e[n][1].length>0&&t.push(e[n]);return t}([[0,e],[t,n],[1,r],[0,o]])}function f(e,t,r){return n(e,t,r,!0)}f.INSERT=1,f.DELETE=t,f.EQUAL=0,e.exports=f},5014:(e,t,n)=>{"use strict";n(4944),n(3792),Object.defineProperty(t,"__esModule",{value:!0});const r=n(2681),o=n(2067),i=n(9912),{Response:s}="undefined"!=typeof FHIRCLIENT_PURE?window:n(4098),a=r.debug.extend("client");function c(e,t,n,o,i){let s=r.makeArray(t.resolveReferences).filter(Boolean).map((e=>String(e).trim())).filter(Boolean);if(s=s.filter(((e,t)=>!(s.indexOf(e,t+1)>-1&&(a('Duplicated reference path "%s"',e),1)))),!s.length)return Promise.resolve();const c={};s.forEach((e=>{const t=e.split(".").length;c[t]||(c[t]=[]),c[t].push(e)}));let u=Promise.resolve();return Object.keys(c).sort().forEach((s=>{const a=c[s];u=u.then((()=>Promise.all(a.map((s=>function(e,t,n,o,i,s){const a=r.getPath(e,t);if(a){const c=Array.isArray(a);return Promise.all(r.makeArray(a).filter(Boolean).map(((a,u)=>{const l=a.reference;if(l)return function(e,t,n,r){return t[e]||(t[e]=n.request({url:e,signal:r}).then((n=>(t[e]=n,n)),(n=>{throw delete t[e],n}))),Promise.resolve(t[e])}(l,o,i,s).then((o=>{n&&(c?t.indexOf("..")>-1?r.setPath(e,`${t.replace("..",`.${u}.`)}`,o):r.setPath(e,`${t}.${u}`,o):r.setPath(e,t,o))})).catch((e=>{if(404!==e.status)throw e}))})))}}(e,s,!!t.graph,n,o,i))))))})),u}t.default=class{constructor(e,t){this.units=r.units;const n="string"==typeof t?{serverUrl:t}:t;if(!n.serverUrl||!n.serverUrl.match(/https?:\/\/.+/))throw new Error('A "serverUrl" option is required and must begin with "http(s)"');this.state=n,this.environment=e,this._refreshTask=null;const o=this;this.patient={get id(){return o.getPatientId()},read:(e={})=>{const t=this.patient.id;return t?this.request(Object.assign(Object.assign({},e),{url:`Patient/${t}`})):Promise.reject(new Error("Patient is not available"))},request:(e,t={})=>this.patient.id?(async()=>{const n=await async function(e,t){const n=r.absolute("/",t.state.serverUrl);async function o(e){const n=e.pathname.split("/").pop();if(!n)throw new Error(`Invalid url "${e}"`);if(-1==i.patientCompartment.indexOf(n))throw new Error(`Cannot filter "${n}" resources by patient`);const o=await r.fetchConformanceStatement(t.state.serverUrl),s=r.getPatientParam(o,n);return e.searchParams.set(s,t.patient.id),e.href}return"string"==typeof e||e instanceof URL?{url:await o(new URL(e+"",n))}:(e.url=await o(new URL(e.url+"",n)),e)}(e,this);return this.request(n,t)})():Promise.reject(new Error("Patient is not available"))},this.encounter={get id(){return o.getEncounterId()},read:(e={})=>{const t=this.encounter.id;return t?this.request(Object.assign(Object.assign({},e),{url:`Encounter/${t}`})):Promise.reject(new Error("Encounter is not available"))}},this.user={get fhirUser(){return o.getFhirUser()},get id(){return o.getUserId()},get resourceType(){return o.getUserType()},read:(e={})=>{const t=this.user.fhirUser;return t?this.request(Object.assign(Object.assign({},e),{url:t})):Promise.reject(new Error("User is not available"))}},this.connect(e.fhir)}connect(e){if("function"==typeof e){const t={baseUrl:this.state.serverUrl.replace(/\/$/,"")},n=this.getState("tokenResponse.access_token");if(n)t.auth={token:n};else{const{username:e,password:n}=this.state;e&&n&&(t.auth={user:e,pass:n})}this.api=e(t);const r=this.getState("tokenResponse.patient");r&&(this.patient.api=e(Object.assign(Object.assign({},t),{patient:r})))}return this}getPatientId(){const e=this.state.tokenResponse;return e?e.patient?e.patient:((this.state.scope||"").match(/\blaunch(\/patient)?\b/)?a("The ID of the selected patient is not available. Please check if your server supports that."):a(o.default.noScopeForId,"patient","patient"),null):(this.state.authorizeUri?a(o.default.noIfNoAuth,"the ID of the selected patient"):a(o.default.noFreeContext,"selected patient"),null)}getEncounterId(){const e=this.state.tokenResponse;return e?e.encounter?e.encounter:((this.state.scope||"").match(/\blaunch(\/encounter)?\b/)?a("The ID of the selected encounter is not available. Please check if your server supports that, and that the selected patient has any recorded encounters."):a(o.default.noScopeForId,"encounter","encounter"),null):(this.state.authorizeUri?a(o.default.noIfNoAuth,"the ID of the selected encounter"):a(o.default.noFreeContext,"selected encounter"),null)}getIdToken(){const e=this.state.tokenResponse;if(e){const t=e.id_token,n=this.state.scope||"";if(!t){const e=n.match(/\bopenid\b/),t=n.match(/\bprofile\b/),r=n.match(/\bfhirUser\b/);return a(e&&(r||t)?"The id_token is not available. Please check if your server supports that.":"You are trying to get the id_token but you are not using the right scopes. Please add 'openid' and 'fhirUser' or 'profile' to the scopes you are requesting."),null}return r.jwtDecode(t,this.environment)}return this.state.authorizeUri?a(o.default.noIfNoAuth,"the id_token"):a(o.default.noFreeContext,"id_token"),null}getFhirUser(){const e=this.getIdToken();return e?e.profile:null}getUserId(){const e=this.getFhirUser();return e?e.split("/")[1]:null}getUserType(){const e=this.getFhirUser();return e?e.split("/")[0]:null}getAuthorizationHeader(){const e=this.getState("tokenResponse.access_token");if(e)return"Bearer "+e;const{username:t,password:n}=this.state;return t&&n?"Basic "+this.environment.btoa(t+":"+n):null}async _clearState(){const e=this.environment.getStorage(),t=await e.get(i.SMART_KEY);t&&await e.unset(t),await e.unset(i.SMART_KEY),this.state.tokenResponse={}}create(e,t={}){return this.request(Object.assign(Object.assign({},t),{url:`${e.resourceType}`,method:"POST",body:JSON.stringify(e),headers:Object.assign({"Content-Type":"application/json"},t.headers)}))}update(e,t={}){return this.request(Object.assign(Object.assign({},t),{url:`${e.resourceType}/${e.id}`,method:"PUT",body:JSON.stringify(e),headers:Object.assign({"Content-Type":"application/json"},t.headers)}))}delete(e,t={}){return this.request(Object.assign(Object.assign({},t),{url:e,method:"DELETE"}))}async request(e,t={},n={}){var i;const a=r.debug.extend("client:request");if(!e)throw new Error("request requires an url or request options as argument");let u;"string"==typeof e||e instanceof URL?(u=String(e),e={}):u=String(e.url),u=r.absolute(u,this.state.serverUrl);const l={graph:!1!==t.graph,flat:!!t.flat,pageLimit:null!==(i=t.pageLimit)&&void 0!==i?i:1,resolveReferences:t.resolveReferences||[],useRefreshToken:!1!==t.useRefreshToken,onPage:"function"==typeof t.onPage?t.onPage:void 0},d=e.signal||void 0;return(l.useRefreshToken?this.refreshIfNeeded({signal:d}).then((()=>e)):Promise.resolve(e)).then((e=>{const t=this.getAuthorizationHeader();return t&&(e.headers=Object.assign(Object.assign({},e.headers),{Authorization:t})),e})).then((e=>(a("%s, options: %O, fhirOptions: %O",u,e,l),r.request(u,e)))).catch((async e=>{if(401==e.status){if(!this.getState("tokenResponse.access_token"))throw new Error("This app cannot be accessed directly. Please launch it as SMART app!");if(!l.useRefreshToken)throw a("Your session has expired and the useRefreshToken option is set to false. Please re-launch the app."),await this._clearState(),new Error(o.default.expired);throw a("Auto-refresh failed! Please re-launch the app."),await this._clearState(),new Error(o.default.expired)}throw e})).catch((e=>{throw 403==e.status&&a("Permission denied! Please make sure that you have requested the proper scopes."),e})).then((e=>e?"string"==typeof e||e instanceof s?e:(async e=>("Bundle"==e.resourceType?await Promise.all((e.entry||[]).map((e=>c(e.resource,l,n,this,d)))):await c(e,l,n,this,d),e))(e).then((async e=>{if(e&&"Bundle"==e.resourceType){const t=e.link||[];if(l.flat&&(e=(e.entry||[]).map((e=>e.resource))),l.onPage&&await l.onPage(e,Object.assign({},n)),--l.pageLimit){const o=t.find((e=>"next"==e.relation));if(e=r.makeArray(e),o&&o.url){const t=await this.request({url:o.url,signal:d},l,n);return l.onPage?null:l.resolveReferences.length?(Object.assign(n,t.references),e.concat(r.makeArray(t.data||t))):e.concat(r.makeArray(t))}}}return e})).then((e=>{if(l.graph)n={};else if(!l.onPage&&l.resolveReferences.length)return{data:e,references:n};return e})):e))}refreshIfNeeded(e={}){const t=this.getState("tokenResponse.access_token"),n=this.getState("tokenResponse.refresh_token"),r=this.state.expiresAt||0;return t&&n&&r-10<Date.now()/1e3?this.refresh(e):Promise.resolve(this.state)}refresh(e={}){var t,n;const o=r.debug.extend("client:refresh");o("Attempting to refresh with refresh_token...");const i=null===(n=null===(t=this.state)||void 0===t?void 0:t.tokenResponse)||void 0===n?void 0:n.refresh_token;if(!i)throw new Error("Unable to refresh. No refresh_token found.");const s=this.state.tokenUri;if(!s)throw new Error("Unable to refresh. No tokenUri found.");const a=this.getState("tokenResponse.scope")||"",c=a.search(/\boffline_access\b/)>-1,u=a.search(/\bonline_access\b/)>-1;if(!c&&!u)throw new Error("Unable to refresh. No offline_access or online_access scope found.");if(!this._refreshTask){const t=Object.assign(Object.assign({credentials:this.environment.options.refreshTokenWithCredentials||"same-origin"},e),{method:"POST",mode:"cors",headers:Object.assign(Object.assign({},e.headers||{}),{"content-type":"application/x-www-form-urlencoded"}),body:`grant_type=refresh_token&refresh_token=${encodeURIComponent(i)}`});if(!("authorization"in t.headers)){const{clientSecret:e,clientId:n}=this.state;e&&(t.headers.authorization="Basic "+this.environment.btoa(n+":"+e))}this._refreshTask=r.request(s,t).then((e=>{if(!e.access_token)throw new Error("No access token received");return o("Received new access token response %O",e),Object.assign(this.state.tokenResponse,e),this.state.expiresAt=r.getAccessTokenExpiration(e,this.environment),this.state})).catch((e=>{var t,n;throw(null===(n=null===(t=this.state)||void 0===t?void 0:t.tokenResponse)||void 0===n?void 0:n.refresh_token)&&(o("Deleting the expired or invalid refresh token."),delete this.state.tokenResponse.refresh_token),e})).finally((()=>{this._refreshTask=null;const e=this.state.key;e?this.environment.getStorage().set(e,this.state):o("No 'key' found in Clint.state. Cannot persist the instance.")}))}return this._refreshTask}byCode(e,t){return r.byCode(e,t)}byCodes(e,t){return r.byCodes(e,t)}getPath(e,t=""){return r.getPath(e,t)}getState(e=""){return r.getPath(Object.assign({},this.state),e)}getFhirVersion(){return r.fetchConformanceStatement(this.state.serverUrl).then((e=>e.fhirVersion))}getFhirRelease(){return this.getFhirVersion().then((e=>{var t;return null!==(t=i.fhirVersions[e])&&void 0!==t?t:0}))}}},6057:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e="Unknown error",t=0,n="Error",r=null){super(e),this.message=e,this.name="HttpError",this.statusCode=t,this.status=t,this.statusText=n,this.body=r}toJSON(){return{name:this.name,statusCode:this.statusCode,status:this.status,statusText:this.statusText,message:this.message,body:this.body}}}t.default=n},3338:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6671),o=n(5014),i=n(5596);t.default=class{constructor(e={}){this._url=null,this._storage=null,this.options=Object.assign({replaceBrowserHistory:!0,fullSessionStorageSupport:!0,refreshTokenWithCredentials:"same-origin"},e)}relative(e){return new URL(e,this.getUrl().href).href}get fhir(){return"function"==typeof fhir?fhir:null}getUrl(){return this._url||(this._url=new URL(location+"")),this._url}redirect(e){location.href=e}getStorage(){return this._storage||(this._storage=new i.default),this._storage}getAbortController(){return AbortController}atob(e){return window.atob(e)}btoa(e){return window.btoa(e)}getSmartApi(){return{ready:(...e)=>r.ready(this,...e),authorize:e=>r.authorize(this,e),init:e=>r.init(this,e),client:e=>new o.default(this,e),options:this.options}}}},5832:(e,t,n)=>{"use strict";const r=new(n(3338).default),{ready:o,authorize:i,init:s,client:a,options:c}=r.getSmartApi();if("undefined"==typeof FHIRCLIENT_PURE){const e=n(4098);n(6486),window.fetch||(window.fetch=e.default,window.Headers=e.Headers,window.Request=e.Request,window.Response=e.Response)}const u={AbortController:window.AbortController,client:a,oauth2:{settings:c,ready:o,authorize:i,init:s}};e.exports=u},2681:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=t.getPatientParam=t.byCodes=t.byCode=t.getAccessTokenExpiration=t.jwtDecode=t.randomString=t.absolute=t.makeArray=t.setPath=t.getPath=t.humanizeError=t.fetchConformanceStatement=t.getAndCache=t.request=t.responseToJSON=t.checkResponse=t.units=t.debug=void 0;const r=n(6057),o=n(9912),i=n(1227),{fetch:s}="undefined"!=typeof FHIRCLIENT_PURE?window:n(4098),a=i("FHIR");t.debug=a;const c={};function u({value:e,code:t}){if("number"!=typeof e)throw new Error("Found a non-numerical unit: "+e+" "+t)}async function l(e){if(!e.ok)throw await p(e);return e}function d(e){return e.text().then((e=>e.length?JSON.parse(e):""))}function f(e,t={}){return s(e,Object.assign(Object.assign({mode:"cors"},t),{headers:Object.assign({accept:"application/json"},t.headers)})).then(l).then((e=>{const t=e.headers.get("Content-Type")+"";return t.match(/\bjson\b/i)?d(e).then((t=>({res:e,body:t}))):t.match(/^text\//i)?e.text().then((t=>({res:e,body:t}))):{res:e}})).then((({res:e,body:n})=>{if(!n&&201==e.status){const n=e.headers.get("location")+"";if(n)return f(n,Object.assign(Object.assign({},t),{method:"GET",body:null}))}return void 0===n?e:n}))}function h(e,t,n=!1){return n||!c[e]?(c[e]=f(e,t),c[e]):Promise.resolve(c[e])}async function p(e){let t=`${e.status} ${e.statusText}\nURL: ${e.url}`,n=null;try{const r=e.headers.get("Content-Type")||"text/plain";r.match(/\bjson\b/i)?(n=await e.json(),n.error?(t+="\n"+n.error,n.error_description&&(t+=": "+n.error_description)):t+="\n\n"+JSON.stringify(n,null,4)):r.match(/^text\//i)&&(n=await e.text(),n&&(t+="\n\n"+n))}catch(e){}throw new r.default(t,e.status,e.statusText,n)}function g(e,t=""){if(!(t=t.trim()))return e;let n=t.split("."),r=e;for(;r&&n.length;){const e=n.shift();if(!e&&Array.isArray(r))return r.map((e=>g(e,n.join("."))));r=r[e]}return r}function m(e){return Array.isArray(e)?e:[e]}function y(e,t){const n=e.split(".")[1];return n?JSON.parse(t.atob(n)):null}function b(e,t){const n={};function r(e,t){e&&Array.isArray(e.coding)&&e.coding.forEach((({code:e})=>{e&&(n[e]=n[e]||[],n[e].push(t))}))}return m(e).forEach((e=>{"Observation"===e.resourceType&&e[t]&&(Array.isArray(e[t])?e[t].forEach((t=>r(t,e))):r(e[t],e))})),n}t.units={cm({code:e,value:t}){if(u({code:e,value:t}),"cm"==e)return t;if("m"==e)return 100*t;if("in"==e)return 2.54*t;if("[in_us]"==e)return 2.54*t;if("[in_i]"==e)return 2.54*t;if("ft"==e)return 30.48*t;if("[ft_us]"==e)return 30.48*t;throw new Error("Unrecognized length unit: "+e)},kg({code:e,value:t}){if(u({code:e,value:t}),"kg"==e)return t;if("g"==e)return t/1e3;if(e.match(/lb/))return t/2.20462;if(e.match(/oz/))return t/35.274;throw new Error("Unrecognized weight unit: "+e)},any:e=>(u(e),e.value)},t.checkResponse=l,t.responseToJSON=d,t.request=f,t.getAndCache=h,t.fetchConformanceStatement=function(e="/",t){const n=String(e).replace(/\/*$/,"/")+"metadata";return h(n,t).catch((e=>{throw new Error(`Failed to fetch the conformance statement from "${n}". ${e}`)}))},t.humanizeError=p,t.getPath=g,t.setPath=function(e,t,n,r=!1){return t.trim().split(".").reduce(((e,t,o,i)=>{if(!e||o!==i.length-1)return e&&void 0===e[t]&&r&&(e[t]=i[o+1].match(/^[0-9]+$/)?[]:{}),e?e[t]:void 0;e[t]=n}),e),e},t.makeArray=m,t.absolute=function(e,t){return e.match(/^http/)||e.match(/^urn/)?e:String(t||"").replace(/\/+$/,"")+"/"+e.replace(/^\/+/,"")},t.randomString=function(e=8,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"){const n=[],r=t.length;for(;e--;)n.push(t.charAt(Math.floor(Math.random()*r)));return n.join("")},t.jwtDecode=y,t.getAccessTokenExpiration=function(e,t){const n=Math.floor(Date.now()/1e3);if(e.expires_in)return n+e.expires_in;if(e.access_token){let n=y(e.access_token,t);if(n&&n.exp)return n.exp}return n+300},t.byCode=b,t.byCodes=function(e,t){const n=b(e,t);return(...e)=>e.filter((e=>e+""in n)).reduce(((e,t)=>e.concat(n[t+""])),[])},t.getPatientParam=function(e,t){const n=(g(e,"rest.0.resource")||[]).find((e=>e.type===t));if(!n)throw new Error(`Resource "${t}" is not supported by this FHIR server`);if(!Array.isArray(n.searchParam))throw new Error(`No search parameters supported for "${t}" on this FHIR server`);if("Patient"==t&&n.searchParam.find((e=>"_id"==e.name)))return"_id";const r=o.patientParams.find((e=>n.searchParam.find((t=>t.name==e))));if(!r)throw new Error("I don't know what param to use for "+t);return r},t.getTargetWindow=async function(e,t=800,n=720){if("function"==typeof e&&(e=await e()),e&&"object"==typeof e)return e;if("string"!=typeof e)return a("Invalid target type '%s'. Failing back to '_self'.",typeof e),self;if("_self"==e)return self;if("_parent"==e)return parent;if("_top"==e)return top;if("_blank"==e){let e,t=null;try{if(t=window.open("","SMARTAuthPopup"),!t)throw new Error("Perhaps window.open was blocked")}catch(t){e=t}return t||(a("Cannot open window. Failing back to '_self'. %s",e),self)}if("popup"==e){let e,r=null;try{if(r=window.open("","SMARTAuthPopup",["height="+n,"width="+t,"menubar=0","resizable=1","status=0","top="+(screen.height-n)/2,"left="+(screen.width-t)/2].join(",")),!r)throw new Error("Perhaps the popup window was blocked")}catch(t){e=t}return r||(a("Cannot open window. Failing back to '_self'. %s",e),self)}return frames[e]||(a("Unknown target '%s'. Failing back to '_self'.",e),self)}},9912:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SMART_KEY=t.patientParams=t.fhirVersions=t.patientCompartment=void 0,t.patientCompartment=["Account","AdverseEvent","AllergyIntolerance","Appointment","AppointmentResponse","AuditEvent","Basic","BodySite","BodyStructure","CarePlan","CareTeam","ChargeItem","Claim","ClaimResponse","ClinicalImpression","Communication","CommunicationRequest","Composition","Condition","Consent","Coverage","CoverageEligibilityRequest","CoverageEligibilityResponse","DetectedIssue","DeviceRequest","DeviceUseRequest","DeviceUseStatement","DiagnosticOrder","DiagnosticReport","DocumentManifest","DocumentReference","EligibilityRequest","Encounter","EnrollmentRequest","EpisodeOfCare","ExplanationOfBenefit","FamilyMemberHistory","Flag","Goal","Group","ImagingManifest","ImagingObjectSelection","ImagingStudy","Immunization","ImmunizationEvaluation","ImmunizationRecommendation","Invoice","List","MeasureReport","Media","MedicationAdministration","MedicationDispense","MedicationOrder","MedicationRequest","MedicationStatement","MolecularSequence","NutritionOrder","Observation","Order","Patient","Person","Procedure","ProcedureRequest","Provenance","QuestionnaireResponse","ReferralRequest","RelatedPerson","RequestGroup","ResearchSubject","RiskAssessment","Schedule","ServiceRequest","Specimen","SupplyDelivery","SupplyRequest","VisionPrescription"],t.fhirVersions={"0.4.0":2,"0.5.0":2,"1.0.0":2,"1.0.1":2,"1.0.2":2,"1.1.0":3,"1.4.0":3,"1.6.0":3,"1.8.0":3,"3.0.0":3,"3.0.1":3,"3.3.0":4,"3.5.0":4,"4.0.0":4,"4.0.1":4},t.patientParams=["patient","subject","requester","member","actor","beneficiary"],t.SMART_KEY="SMART_KEY"},6671:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.ready=t.buildTokenRequest=t.completeAuth=t.onMessage=t.isInPopUp=t.isInFrame=t.authorize=t.getSecurityExtensions=t.fetchWellKnownJson=t.KEY=void 0;const r=n(2681),o=n(5014),i=n(9912);Object.defineProperty(t,"KEY",{enumerable:!0,get:function(){return i.SMART_KEY}});const s=r.debug.extend("oauth2");function a(){return"object"==typeof window}function c(e="/",t){const n=String(e).replace(/\/*$/,"/")+".well-known/smart-configuration";return r.getAndCache(n,t).catch((e=>{throw new Error(`Failed to fetch the well-known json "${n}". ${e.message}`)}))}function u(e="/",t){return c(e,t).then((e=>{if(!e.authorization_endpoint||!e.token_endpoint)throw new Error("Invalid wellKnownJson");return{registrationUri:e.registration_endpoint||"",authorizeUri:e.authorization_endpoint,tokenUri:e.token_endpoint}}))}function l(e="/",t){return r.fetchConformanceStatement(e,t).then((e=>{const t=(r.getPath(e||{},"rest.0.security.extension")||[]).filter((e=>"http://fhir-registry.smarthealthit.org/StructureDefinition/oauth-uris"===e.url)).map((e=>e.extension))[0],n={registrationUri:"",authorizeUri:"",tokenUri:""};return t&&t.forEach((e=>{"register"===e.url&&(n.registrationUri=e.valueUri),"authorize"===e.url&&(n.authorizeUri=e.valueUri),"token"===e.url&&(n.tokenUri=e.valueUri)})),n}))}function d(e,t="/"){const n=e.getAbortController(),r=new n,o=new n;return function(e){const t=e.length,n=[];let r=!1;return new Promise(((o,i)=>{function s(e){n.push(e)===t&&i(new Error(n.map((e=>e.message)).join("; ")))}e.forEach((t=>{t.promise.then((n=>function(t,n){t.complete=!0,r||(r=!0,e.forEach((e=>{e.complete||e.controller.abort()})),o(n))}(t,n)),s)}))}))}([{controller:r,promise:u(t,{signal:r.signal})},{controller:o,promise:l(t,{signal:o.signal})}])}async function f(e,t={},n=!1){const{redirect_uri:o,clientSecret:c,fakeTokenResponse:u,patientId:l,encounterId:f,client_id:m,target:y,width:b,height:v}=t;let{iss:w,launch:_,fhirServiceUrl:E,redirectUri:x,scope:k="",clientId:O,completeInTarget:S}=t;const T=e.getUrl(),L=e.getStorage();w=T.searchParams.get("iss")||w,E=T.searchParams.get("fhirServiceUrl")||E,_=T.searchParams.get("launch")||_,O||(O=m),x||(x=o),x?x.match(/^https?\:\/\//)||(x=e.relative(x)):x=e.relative(".");const C=String(w||E||"");if(!C)throw new Error("No server url found. It must be specified as `iss` or as `fhirServiceUrl` parameter");if(w&&s("Making %s launch...",_?"EHR":"standalone"),_&&!k.match(/launch/)&&(k+=" launch"),a()){const e=h(),t=p();(e||t)&&!0!==S&&!1!==S&&(S=e,console.warn('Your app is being authorized from within an iframe or popup window. Please be explicit and provide a "completeInTarget" option. Use "true" to complete the authorization in the same window, or "false" to try to complete it in the parent or the opener window. See http://docs.smarthealthit.org/client-js/api.html'))}const A=await L.get(i.SMART_KEY);await L.unset(A);const j=r.randomString(16),P={clientId:O,scope:k,redirectUri:x,serverUrl:C,clientSecret:c,tokenResponse:{},key:j,completeInTarget:S};(!a()||r.getPath(e,"options.fullSessionStorageSupport"))&&await L.set(i.SMART_KEY,j),u&&Object.assign(P.tokenResponse,u),l&&Object.assign(P.tokenResponse,{patient:l}),f&&Object.assign(P.tokenResponse,{encounter:f});let R=x+"?state="+encodeURIComponent(j);if(E&&!w)return s("Making fake launch..."),await L.set(j,P),n?R:await e.redirect(R);const F=await d(e,C);if(Object.assign(P,F),await L.set(j,P),!P.authorizeUri)return n?R:await e.redirect(R);const N=["response_type=code","client_id="+encodeURIComponent(O||""),"scope="+encodeURIComponent(k),"redirect_uri="+encodeURIComponent(x),"aud="+encodeURIComponent(C),"state="+encodeURIComponent(j)];if(_&&N.push("launch="+encodeURIComponent(_)),R=P.authorizeUri+"?"+N.join("&"),n)return R;if(!y||!a())return await e.redirect(R);{let e;if(e=await r.getTargetWindow(y,b,v),e!==self)try{e.sessionStorage.removeItem(A),e.sessionStorage.setItem(j,JSON.stringify(P))}catch(t){r.debug('Failed to modify window.sessionStorage. Perhaps it is from different origin?. Failing back to "_self". %s',t),e=self}if(e!==self)try{e.location.href=R,self.addEventListener("message",g)}catch(e){r.debug('Failed to modify window.location. Perhaps it is from different origin?. Failing back to "_self". %s',e),self.location.href=R}else self.location.href=R}}function h(){try{return self!==top&&parent!==self}catch(e){return!0}}function p(){try{return self===top&&!!opener&&opener!==self&&!!window.name}catch(e){return!1}}function g(e){"completeAuth"==e.data.type&&e.origin===new URL(self.location.href).origin&&(window.removeEventListener("message",g),window.location.href=e.data.url)}async function m(e){var t,n;const c=e.getUrl(),u=e.getStorage(),l=c.searchParams;let d=l.get("state");const f=l.get("code"),g=l.get("error"),m=l.get("error_description");if(d||(d=await u.get(i.SMART_KEY)),g||m)throw new Error([g,m].filter(Boolean).join(": "));if(s("key: %s, code: %s",d,f),!d)throw new Error("No 'state' parameter found. Please (re)launch the app.");let b=await u.get(d);const v=!a()||r.getPath(e,"options.fullSessionStorageSupport");if(a()&&b&&!b.completeInTarget){const e=h(),t=p();if((e||t)&&!c.searchParams.get("complete")){c.searchParams.set("complete","1");const{href:n,origin:r}=c;return e&&parent.postMessage({type:"completeAuth",url:n},r),t&&(opener.postMessage({type:"completeAuth",url:n},r),window.close()),new Promise((()=>{}))}}c.searchParams.delete("complete");const w=l.has("state");if(a()&&r.getPath(e,"options.replaceBrowserHistory")&&(f||w)&&(f&&(l.delete("code"),s("Removed code parameter from the url.")),w&&v&&(l.delete("state"),s("Removed state parameter from the url.")),window.history.replaceState&&window.history.replaceState({},"",c.href)),!b)throw new Error("No state found! Please (re)launch the app.");if(f&&!(null===(t=b.tokenResponse)||void 0===t?void 0:t.access_token)&&b.tokenUri){if(!f)throw new Error("'code' url parameter is required");s("Preparing to exchange the code for access token...");const t=y(e,f,b);s("Token request options: %O",t);const n=await r.request(b.tokenUri,t);if(s("Token response: %O",n),!n.access_token)throw new Error("Failed to obtain access token.");b.expiresAt=r.getAccessTokenExpiration(n,e),b=Object.assign(Object.assign({},b),{tokenResponse:n}),await u.set(d,b),s("Authorization successful!")}else s((null===(n=b.tokenResponse)||void 0===n?void 0:n.access_token)?"Already authorized":"No authorization needed");v&&await u.set(i.SMART_KEY,d);const _=new o.default(e,b);return s("Created client instance: %O",_),_}function y(e,t,n){const{redirectUri:r,clientSecret:o,tokenUri:i,clientId:a}=n;if(!r)throw new Error("Missing state.redirectUri");if(!i)throw new Error("Missing state.tokenUri");if(!a)throw new Error("Missing state.clientId");const c={method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:`code=${t}&grant_type=authorization_code&redirect_uri=${encodeURIComponent(r)}`};return o?(c.headers.Authorization="Basic "+e.btoa(a+":"+o),s("Using state.clientSecret to construct the authorization header: %s",c.headers.Authorization)):(s("No clientSecret found in state. Adding the clientId to the POST body"),c.body+=`&client_id=${encodeURIComponent(a)}`),c}t.fetchWellKnownJson=c,t.getSecurityExtensions=d,t.authorize=f,t.isInFrame=h,t.isInPopUp=p,t.onMessage=g,t.completeAuth=m,t.buildTokenRequest=y,t.ready=async function(e,t,n){let r=m(e);return t&&(r=r.then(t)),n&&(r=r.catch(n)),r},t.init=async function(e,t){const n=e.getUrl(),r=n.searchParams.get("code"),s=n.searchParams.get("state");if(r&&s)return m(e);const a=e.getStorage(),c=s||await a.get(i.SMART_KEY),u=await a.get(c);return u?new o.default(e,u):f(e,t).then((()=>new Promise((()=>{}))))}},5596:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{async get(e){const t=sessionStorage[e];return t?JSON.parse(t):null}async set(e,t){return sessionStorage[e]=JSON.stringify(t),t}async unset(e){return e in sessionStorage&&(delete sessionStorage[e],!0)}}},2067:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={expired:"Session expired! Please re-launch the app",noScopeForId:"Trying to get the ID of the selected %s. Please add 'launch' or 'launch/%s' to the requested scopes and try again.",noIfNoAuth:"You are trying to get %s but the app is not authorized yet.",noFreeContext:"Please don't use open fhir servers if you need to access launch context items like the %S."}},1379:(e,t,n)=>{"use strict";function r(){}function o(e,t){for(const n in t)e[n]=t[n];return e}function i(e){return e()}function s(){return Object.create(null)}function a(e){e.forEach(i)}function c(e){return"function"==typeof e}function u(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(e){return 0===Object.keys(e).length}function d(e,...t){if(null==e)return r;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function f(e){let t;return d(e,(e=>t=e))(),t}function h(e,t,n){e.$$.on_destroy.push(d(t,n))}function p(e,t,n,r){if(e){const o=g(e,t,n,r);return e[0](o)}}function g(e,t,n,r){return e[1]&&r?o(n.ctx.slice(),e[1](r(t))):n.ctx}function m(e,t,n,r,o,i,s){const a=function(e,t,n,r){if(e[2]&&r){const o=e[2](r(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|o[r];return e}return t.dirty|o}return t.dirty}(t,r,o,i);if(a){const o=g(t,n,r,s);e.p(o,a)}}function y(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function b(e,t){e.appendChild(t)}function v(e,t,n){e.insertBefore(t,n||null)}function w(e){e.parentNode.removeChild(e)}function _(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function E(e){return document.createElement(e)}function x(e){return document.createTextNode(e)}function k(){return x(" ")}function O(){return x("")}function S(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function T(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}let L;function C(e){L=e}function A(){if(!L)throw new Error("Function called outside component initialization");return L}function j(e){A().$$.on_mount.push(e)}function P(e){A().$$.on_destroy.push(e)}function R(e,t){A().$$.context.set(e,t)}function F(e){return A().$$.context.get(e)}n.d(t,{f_:()=>ie,R3:()=>b,f0:()=>o,Lj:()=>S,Vn:()=>$,gb:()=>Z,FI:()=>h,YC:()=>te,nu:()=>p,vp:()=>re,RM:()=>_,og:()=>w,bG:()=>E,cS:()=>O,Jv:()=>y,fw:()=>F,gC:()=>ee,Lo:()=>Q,$X:()=>f,dv:()=>K,S1:()=>oe,$T:()=>v,sB:()=>c,ye:()=>ne,ZT:()=>r,ev:()=>P,H3:()=>j,j7:()=>a,N8:()=>u,v:()=>R,rT:()=>T,Dh:()=>k,Ld:()=>d,fL:()=>x,Ui:()=>G,et:()=>X,Tj:()=>m}),new Set,new Set;const N=[],$=[],M=[],D=[],I=Promise.resolve();let U=!1;function B(e){M.push(e)}let z=!1;const q=new Set;function H(){if(!z){z=!0;do{for(let e=0;e<N.length;e+=1){const t=N[e];C(t),Y(t.$$)}for(C(null),N.length=0;$.length;)$.pop()();for(let e=0;e<M.length;e+=1){const t=M[e];q.has(t)||(q.add(t),t())}M.length=0}while(N.length);for(;D.length;)D.pop()();U=!1,z=!1,q.clear()}}function Y(e){if(null!==e.fragment){e.update(),a(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(B)}}const W=new Set;let V,J;function K(){V={r:0,c:[],p:V}}function Z(){V.r||a(V.c),V=V.p}function G(e,t){e&&e.i&&(W.delete(e),e.i(t))}function X(e,t,n,r){if(e&&e.o){if(W.has(e))return;W.add(e),V.c.push((()=>{W.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}function Q(e,t){const n={},r={},o={$$scope:1};let i=e.length;for(;i--;){const s=e[i],a=t[i];if(a){for(const e in s)e in a||(r[e]=1);for(const e in a)o[e]||(n[e]=a[e],o[e]=1);e[i]=a}else for(const e in s)o[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}function ee(e){return"object"==typeof e&&null!==e?e:{}}function te(e){e&&e.c()}function ne(e,t,n){const{fragment:r,on_mount:o,on_destroy:s,after_update:u}=e.$$;r&&r.m(t,n),B((()=>{const t=o.map(i).filter(c);s?s.push(...t):a(t),e.$$.on_mount=[]})),u.forEach(B)}function re(e,t){const n=e.$$;null!==n.fragment&&(a(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function oe(e,t,n,o,i,c,u=[-1]){const l=L;C(e);const d=e.$$={fragment:null,ctx:null,props:c,update:r,not_equal:i,bound:s(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:s(),dirty:u,skip_bound:!1};let f=!1;if(d.ctx=n?n(e,t.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return d.ctx&&i(d.ctx[t],d.ctx[t]=o)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](o),f&&function(e,t){-1===e.$$.dirty[0]&&(N.push(e),U||(U=!0,I.then(H)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n})):[],d.update(),f=!0,a(d.before_update),d.fragment=!!o&&o(d.ctx),t.target){if(t.hydrate){const e=function(e){return Array.from(e.childNodes)}(t.target);d.fragment&&d.fragment.l(e),e.forEach(w)}else d.fragment&&d.fragment.c();t.intro&&G(e.$$.fragment),ne(e,t.target,t.anchor),H()}C(l)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(J=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}$destroy(){re(this,1),this.$destroy=r}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!l(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class ie{$destroy(){re(this,1),this.$destroy=r}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!l(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}},5120:(e,t,n)=>{"use strict";n.r(t),n.d(t,{get:()=>r.$X,derived:()=>a,readable:()=>i,writable:()=>s});var r=n(1379);const o=[];function i(e,t){return{subscribe:s(e,t).subscribe}}function s(e,t=r.ZT){let n;const i=[];function s(t){if((0,r.N8)(e,t)&&(e=t,n)){const t=!o.length;for(let t=0;t<i.length;t+=1){const n=i[t];n[1](),o.push(n,e)}if(t){for(let e=0;e<o.length;e+=2)o[e][0](o[e+1]);o.length=0}}}return{set:s,update:function(t){s(t(e))},subscribe:function(o,a=r.ZT){const c=[o,a];return i.push(c),1===i.length&&(n=t(s)||r.ZT),o(e),()=>{const e=i.indexOf(c);-1!==e&&i.splice(e,1),0===i.length&&(n(),n=null)}}}}function a(e,t,n){const o=!Array.isArray(e),s=o?[e]:e,a=t.length<2;return i(n,(e=>{let n=!1;const i=[];let c=0,u=r.ZT;const l=()=>{if(c)return;u();const n=t(o?i[0]:i,e);a?e(n):u=(0,r.sB)(n)?n:r.ZT},d=s.map(((e,t)=>(0,r.Ld)(e,(e=>{i[t]=e,c&=~(1<<t),n&&l()}),(()=>{c|=1<<t}))));return n=!0,l(),function(){(0,r.j7)(d),u()}}))}},185:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EditorFormatEvent=t.EditorChangeEvent=void 0;const a=s(n(7415)),c=i(n(4199)),u=s(n(8220)),l=s(n(9801)),d=n(1703),f=n(9967),h=n(7577),p=n(8374),g=s(n(6202)),m=n(8173),y=s(n(7506)),b=n(883),v=n(1081),w={},_=[],E=["focus","blur","keydown","mousedown","mouseup","click"],x=new WeakMap;class k extends Event{constructor(e,t){super(e,t),this.old=t.old,this.doc=t.doc,this.change=t.change,this.changedLines=t.changedLines,this.source=t.source}modify(e){if(!this.cancelable)throw new Error('Cannot modify an applied change, listen to the "changing" event');this.doc=this.doc.apply(e),this.change&&(this.change.delta=this.change.delta.compose(e)),this.changedLines&&(this.changedLines=this.old.lines===this.doc.lines?_:L(this.old,this.doc))}}t.EditorChangeEvent=k;class O extends Event{constructor(e,t){super(e,t),this.formats=t.formats}}t.EditorFormatEvent=O;class S extends y.default{constructor(e={}){super(),this.activeFormats=w,this.commands={},this.shortcuts={},this.modules={},this.identifier=e.identifier,this.typeset=new d.Typeset(e.types||h.defaultTypes),e.doc?this.doc=e.doc:e.html?this.doc=m.docFromHTML(this,e.html):e.text?this.doc=new a.default((new u.default).insert(e.text)):this.doc=new a.default,this._enabled=void 0===e.enabled||e.enabled,this._modules={...f.defaultModules,...e.modules},e.root&&this.setRoot(e.root)}get root(){return this._root||this.setRoot(document.createElement("div")),this._root}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._root&&(this._root.contentEditable=e?"true":"inherit")}get change(){const e=new c.default(this.doc);return e.apply=(t=v.Source.user)=>this.update(e,t),e}setRoot(e){if(!e)throw new TypeError("Root must be set, cannot be "+e);return this.destroy(),this._root=e,this.init(),this.dispatchEvent(new Event("root")),this}update(e,t=v.Source.user){if(!this.enabled&&t===v.Source.user)return this;e instanceof u.default&&(e=new c.default(this.doc,e));const n=this.doc,r=n.apply(e),o=n.lines===r.lines?_:L(n,r);return this.set(r,t,e,o),this}set(e,t=v.Source.user,n,r){const o=this.doc;if(e instanceof u.default&&(e=new a.default(e)),!this.enabled&&t===v.Source.user||!e||o.equals(e))return this;const i=new k("changing",{cancelable:!0,old:o,doc:e,change:n,changedLines:r,source:t});return this.dispatchEvent(i),i.defaultPrevented||o.equals(i.doc)||(this.activeFormats=function(e,t){const{formats:n}=e.typeset;if(!t.selection||0===t.selection[0])return w;const r=p.normalizeRange(t.selection)[0];let o=r;const i=t.getTextFormat(o),s={};return Object.keys(i).forEach((e=>{const o=n.get(e);o&&(!1!==o.greedy||t.getTextFormat(r)[e])&&(s[e]=i[e])})),s}(this,i.doc),this.doc=i.doc,this.dispatchEvent(new k("change",{...i,cancelable:!1})),this.dispatchEvent(new k("changed",{...i,cancelable:!1}))),this}getHTML(){return m.docToHTML(this,this.doc)}setHTML(e,t=this.doc.selection,n){return this.set(m.docFromHTML(this,e,t))}getDelta(){return this.doc.toDelta()}setDelta(e,t=this.doc.selection,n){return this.set(new a.default(e,t),n)}getText(e){return this.doc.getText(e)}setText(e,t=this.doc.selection,n){return this.set(new a.default((new u.default).insert(e),t),n)}getActive(){const{selection:e}=this.doc;let t=e?e[0]===e[1]?{...this.activeFormats,...this.doc.getLineFormat(e)}:{...this.doc.getFormats(e)}:{};return Object.values(this.modules).forEach((e=>{e.getActive&&(t={...t,...e.getActive()})})),t}select(e){return this.update(this.change.select(e))}insert(e,t,n=this.doc.selection,r){if(!n)return this;null==t&&"string"==typeof e&&"\n"!==e&&(t=this.activeFormats);const o=this.typeset.lines.findByAttributes(t,!0),i=this.change.delete(n),s=p.normalizeRange(n)[0];if("\n"===e&&o.frozen){const e={...this.doc.getLineFormat(s)},n={...t,id:g.default.createId(this.doc.byId)};let r={...e,id:g.default.createId(this.doc.byId)};const o=(new u.default).insert("\n",e);this.doc.getLineRange(s)[1]-1!==s?o.insert("\n",n):r=n,i.insertContent(s,o).formatLine(s,r).select(s+2)}else i.insert(s,e,t,r);return this.update(i)}insertContent(e,t=this.doc.selection){if(!t)return this;const n=this.change.delete(t).insertContent(t[0],e);return this.update(n)}delete(e,t){let n;if(Array.isArray(e))n=p.normalizeRange(e);else{if(!this.doc.selection)return this;n=p.normalizeRange(this.doc.selection),e&&n[0]===n[1]&&(n=e<0?[n[0]+e,n[1]]:[n[0],n[1]+e])}const r=this.change.delete(n,t).select(n[0]);return this.update(r)}formatText(e,t=this.doc.selection){return t?("string"==typeof e&&(e={[e]:!0}),t[0]===t[1]?(this.activeFormats=l.default.compose(this.activeFormats,e)||w,this.dispatchEvent(new O("format",{formats:this.activeFormats})),this):(T(this,"formatText",e,t),this)):this}toggleTextFormat(e,t=this.doc.selection){return t?("string"==typeof e&&(e={[e]:!0}),t[0]===t[1]?(c.hasFormat(e,this.activeFormats)&&(e=l.default.invert(e)),this.activeFormats=l.default.compose(this.activeFormats,e)||w,this.dispatchEvent(new O("format",{formats:this.activeFormats})),this):(T(this,"toggleTextFormat",e,t),this)):this}formatLine(e,t=this.doc.selection){return"string"==typeof e&&(e={[e]:!0}),T(this,"formatLine",e,t),this}toggleLineFormat(e,t=this.doc.selection){return"string"==typeof e&&(e={[e]:!0}),T(this,"toggleLineFormat",e,t),this}indent(){return j(this,1),this}outdent(){return j(this,-1),this}removeFormat(e=this.doc.selection){return T(this,"removeFormat",null,e),this}getBounds(e){var t;return"number"==typeof e&&(e=[e,e]),null===(t=b.getBoudingBrowserRange(this,e))||void 0===t?void 0:t.getBoundingClientRect()}getAllBounds(e){var t;return"number"==typeof e&&(e=[e,e]),null===(t=b.getBoudingBrowserRange(this,e))||void 0===t?void 0:t.getClientRects()}getIndexFromPoint(e,t){return b.getIndexFromPoint(this,e,t)}render(){var e,t,n;return null===(e=this.modules.decorations)||void 0===e||e.gatherDecorations(),null===(t=this.modules.rendering)||void 0===t||t.render(),null===(n=this.modules.selection)||void 0===n||n.renderSelection(),this}init(){const e=this._root;e.editor&&e.editor.destroy(),e.editor=this,this.enabled=this._enabled,this.commands={},E.forEach((e=>this._root.addEventListener(e,P(this)))),this.typeset.lines.list.forEach((e=>e.commands&&C(this,e.name,e.commands(this)))),this.typeset.formats.list.forEach((e=>e.commands&&C(this,e.name,e.commands(this)))),this.typeset.embeds.list.forEach((e=>e.commands&&C(this,e.name,e.commands(this)))),Object.keys(this._modules).forEach((e=>{if(!this._modules[e])return;const t=this.modules[e]=this._modules[e](this);t.commands&&C(this,e,t.commands)})),this.shortcuts=function(e){const t={},{typeset:{lines:n,formats:r,embeds:o},modules:i}=e;return F(n,t),F(r,t),F(o,t),function(e,t){Object.keys(e).forEach((n=>{var r;const o=null===(r=e[n])||void 0===r?void 0:r.shortcuts;o&&N(o,t)}))}(i,t),t}(this),Object.keys(this.modules).forEach((e=>{var t,n;return null===(n=(t=this.modules[e]).init)||void 0===n?void 0:n.call(t)})),this.render()}destroy(){const e=this._root;e&&(E.forEach((t=>e.removeEventListener(t,P(this)))),Object.values(this.modules).forEach((e=>e.destroy&&e.destroy())),this._root=void 0,delete e.editor)}}function T(e,t,n,r){if(!r)return;const o=e.change[t](r,n);e.update(o)}function L(e,t){const n=new Set(e.lines);return t.lines.filter((e=>!n.has(e)))}function C(e,t,n){n&&("function"==typeof n?e.commands[t]=A(e,n):Object.keys(n).forEach((t=>e.commands[t]=A(e,n[t]))))}function A(e,t){return()=>{t(),e.doc.selection&&e.root.focus()}}function j(e,t=1){const{typeset:{lines:n},doc:r}=e,{selection:o}=r;if(!o)return r;const i=e.change;r.getLinesAt(o).forEach((e=>{if(!n.findByAttributes(e.attributes,!0).indentable)return;const o=r.getLineRange(e);let s=(e.attributes.indent||0)+t;s<=0&&(s=null),i.formatLine(o[0],s<0?w:{...e.attributes,indent:s})})),e.update(i)}function P(e){let t=x.get(e);return t||(t=R.bind(e),x.set(e,t)),t}function R(e){this.dispatchEvent(e)}function F(e,t){e.list.forEach((e=>{const n=e.shortcuts;n&&("string"==typeof n?t[n]=e.name:N(n,t))}))}function N(e,t){Object.keys(e).forEach((n=>t[n]=e[n]))}t.default=S},1081:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Source=void 0,(n=t.Source||(t.Source={})).api="api",n.user="user"},9801:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(9419)),i=r(n(6098));var s;function a(e){return e===Object(e)&&!Array.isArray(e)}!function(e){e.compose=function e(t={},n={},r){"object"!=typeof t&&(t={}),"object"!=typeof n&&(n={});let o=i.default(n);for(const n in t)a(t[n])&&a(o[n])&&(o[n]=e(t[n],o[n],r));r||(o=Object.keys(o).reduce(((e,t)=>(null!=o[t]&&(e[t]=o[t]),e)),{}));for(const e in t)void 0!==t[e]&&void 0===n[e]&&(o[e]=t[e]);return Object.keys(o).length>0?o:void 0},e.diff=function e(t={},n={}){"object"!=typeof t&&(t={}),"object"!=typeof n&&(n={});const r=Object.keys(t).concat(Object.keys(n)).reduce(((r,i)=>(o.default(t[i],n[i])||(void 0===n[i]?r[i]=null:a(t[i])&&a(n[i])?r[i]=e(t[i],n[i]):r[i]=n[i]),r)),{});return Object.keys(r).length>0?r:void 0},e.invert=function e(t={},n={}){t=t||{};const r=Object.keys(n).reduce(((r,i)=>(o.default(n[i],t[i])||void 0===t[i]||(a(t[i])&&a(n[i])?r[i]=e(t[i],n[i]):r[i]=n[i]),r)),{});return Object.keys(t).reduce(((e,r)=>(t[r]!==n[r]&&void 0===n[r]&&(e[r]=null),e)),r)},e.transform=function e(t,n,r=!1){if("object"!=typeof t)return n;if("object"!=typeof n)return;if(!r)return n;const o=Object.keys(n).reduce(((r,o)=>(void 0===t[o]?r[o]=n[o]:a(t[o])&&a(n[o])&&(r[o]=e(t[o],n[o],!0)),r)),{});return Object.keys(o).length>0?o:void 0}}(s||(s={})),t.default=s},8220:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(7529)),i=r(n(9419)),s=r(n(9801)),a=r(n(139)),c=String.fromCharCode(0);class u{constructor(e){Array.isArray(e)?this.ops=e:null!=e&&Array.isArray(e.ops)?this.ops=e.ops:this.ops=[]}insert(e,t){const n={};return"string"==typeof e&&0===e.length?this:(n.insert=e,null!=t&&"object"==typeof t&&Object.keys(t).length>0&&(n.attributes=t),this.push(n))}delete(e){return e<=0?this:this.push({delete:e})}retain(e,t){if(e<=0)return this;const n={retain:e};return null!=t&&"object"==typeof t&&Object.keys(t).length>0&&(n.attributes=t),this.push(n)}push(e){let t=this.ops.length,n=this.ops[t-1];if("object"==typeof n){if("number"==typeof e.delete&&"number"==typeof n.delete)return this.ops[t-1]={delete:n.delete+e.delete},this;if("number"==typeof n.delete&&null!=e.insert&&(t-=1,n=this.ops[t-1],"object"!=typeof n))return this.ops.unshift(e),this;if(i.default(e.attributes,n.attributes)){if("string"==typeof e.insert&&"string"==typeof n.insert)return this.ops[t-1]={insert:n.insert+e.insert},"object"==typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this;if("number"==typeof e.retain&&"number"==typeof n.retain)return this.ops[t-1]={retain:n.retain+e.retain},"object"==typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this}}return t===this.ops.length?this.ops.push(e):this.ops.splice(t,0,e),this}chop(){const e=this.ops[this.ops.length-1];return e&&e.retain&&!e.attributes&&this.ops.pop(),this}filter(e){return this.ops.filter(e)}forEach(e){this.ops.forEach(e)}map(e){return this.ops.map(e)}partition(e){const t=[],n=[];return this.forEach((r=>{(e(r)?t:n).push(r)})),[t,n]}reduce(e,t){return this.ops.reduce(e,t)}changeLength(){return this.reduce(((e,t)=>t.insert?e+a.default.length(t):t.delete?e-t.delete:e),0)}length(){return this.reduce(((e,t)=>e+a.default.length(t)),0)}slice(e=0,t=1/0){const n=[],r=a.default.iterator(this.ops);let o=0;for(;o<t&&r.hasNext();){let i;o<e?i=r.next(e-o):(i=r.next(t-o),n.push(i)),o+=a.default.length(i)}return new u(n)}compose(e,t){const n=a.default.iterator(this.ops),r=a.default.iterator(e.ops),o=[],c=r.peek();if(null!=c&&"number"==typeof c.retain&&null==c.attributes){let e=c.retain;for(;"insert"===n.peekType()&&n.peekLength()<=e;)e-=n.peekLength(),o.push(n.next());c.retain-e>0&&r.next(c.retain-e)}const l=new u(o);for(;n.hasNext()||r.hasNext();)if("insert"===r.peekType())l.push(r.next());else if("delete"===n.peekType())l.push(n.next());else{const e=Math.min(n.peekLength(),r.peekLength()),o=n.next(e),a=r.next(e);if("number"==typeof a.retain){let c;const d=a.attributes&&s.default.compose(o.attributes,a.attributes,!t&&"number"==typeof o.retain);if(a.attributes&&!i.default(d,o.attributes)?(c={},"number"==typeof o.retain?c.retain=e:c.insert=o.insert,d&&(c.attributes=d)):c=o.retain===1/0?a:o,l.push(c),a.retain===1/0||!r.hasNext()&&i.default(l.ops[l.ops.length-1],c)){const e=new u(n.rest());return l.concat(e).chop()}}else"number"==typeof a.delete&&"number"==typeof o.retain&&l.push(a)}return l.chop()}concat(e){const t=new u(this.ops.slice());return e.ops.length>0&&(t.push(e.ops[0]),t.ops=t.ops.concat(e.ops.slice(1))),t}diff(e,t){if(this.ops===e.ops)return new u;const n=[this,e].map((t=>t.map((n=>{if(null!=n.insert)return"string"==typeof n.insert?n.insert:c;throw new Error("diff() called "+(t===e?"on":"with")+" non-document")})).join(""))),r=new u,l=o.default(n[0],n[1],t),d=a.default.iterator(this.ops),f=a.default.iterator(e.ops);return l.forEach((e=>{let t=e[1].length;for(;t>0;){let n=0;switch(e[0]){case o.default.INSERT:n=Math.min(f.peekLength(),t),r.push(f.next(n));break;case o.default.DELETE:n=Math.min(t,d.peekLength()),d.next(n),r.delete(n);break;case o.default.EQUAL:n=Math.min(d.peekLength(),f.peekLength(),t);const e=d.next(n),a=f.next(n);i.default(e.insert,a.insert)?r.retain(n,s.default.diff(e.attributes,a.attributes)):r.push(a).delete(n)}t-=n}})),r.chop()}eachLine(e,t="\n"){const n=a.default.iterator(this.ops);let r=new u,o=0;for(;n.hasNext();){if("insert"!==n.peekType())return;const i=n.peek(),s=a.default.length(i)-n.peekLength(),c="string"==typeof i.insert?i.insert.indexOf(t,s)-s:-1;if(c<0)r.push(n.next());else if(c>0)r.push(n.next(c));else{if(!1===e(r,n.next(1).attributes||{},o))return;o+=1,r=new u}}r.length()>0&&e(r,{},o,!0)}invert(e){const t=new u;return this.reduce(((n,r)=>{if(r.insert)t.delete(a.default.length(r));else{if(r.retain&&null==r.attributes)return t.retain(r.retain),n+r.retain;if(r.delete||r.retain&&r.attributes){const o=r.delete||r.retain;return e.slice(n,n+o).forEach((e=>{r.delete?t.push(e):r.retain&&r.attributes&&t.retain(a.default.length(e),s.default.invert(r.attributes,e.attributes))})),n+o}}return n}),0),t.chop()}transform(e,t=!1){if(t=!!t,"number"==typeof e)return this.transformPosition(e,t);const n=e,r=a.default.iterator(this.ops),o=a.default.iterator(n.ops),i=new u;for(;r.hasNext()||o.hasNext();)if("insert"!==r.peekType()||!t&&"insert"===o.peekType())if("insert"===o.peekType())i.push(o.next());else{const e=Math.min(r.peekLength(),o.peekLength()),n=r.next(e),a=o.next(e);if(n.delete)continue;a.delete?i.push(a):i.retain(e,s.default.transform(n.attributes,a.attributes,t))}else i.retain(a.default.length(r.next()));return i.chop()}transformPosition(e,t=!1){t=!!t;const n=a.default.iterator(this.ops);let r=0;for(;n.hasNext()&&r<=e;){const o=n.peekLength(),i=n.peekType();n.next(),"delete"!==i?("insert"===i&&(r<e||!t)&&(e+=o),r+=o):e-=Math.min(o,e-r)}return e}}u.Op=a.default,u.AttributeMap=s.default,t.default=u},3842:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(139));t.default=class{constructor(e){this.ops=e,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(e){e||(e=1/0);const t=this.ops[this.index];if(t){const n=this.offset,r=o.default.length(t);if(e>=r-n?(e=r-n,this.index+=1,this.offset=0):this.offset+=e,"number"==typeof t.delete)return{delete:e};{if(r===e)return t;const o={};return t.attributes&&(o.attributes=t.attributes),"number"==typeof t.retain?o.retain=e:"string"==typeof t.insert?o.insert=t.insert.substr(n,e):o.insert=t.insert,o}}return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?o.default.length(this.ops[this.index])-this.offset:1/0}peekType(){return this.ops[this.index]?"number"==typeof this.ops[this.index].delete?"delete":"number"==typeof this.ops[this.index].retain?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);{const e=this.offset,t=this.index,n=this.next(),r=this.ops.slice(this.index);return this.offset=e,this.index=t,[n].concat(r)}}return[]}}},139:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(3842));var i;!function(e){e.iterator=function(e){return new o.default(e)},e.length=function(e){return"number"==typeof e.delete?e.delete:"number"==typeof e.retain?e.retain:"string"==typeof e.insert?e.insert.length:1}}(i||(i={})),t.default=i},8374:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeRange=void 0,t.normalizeRange=function(e){return e?(e[0]>e[1]&&(e=[e[1],e[0]]),e):e}},7026:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(8220)),i=r(n(6202));t.default=class{constructor(e){this.lines=e,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(e){e||(e=1/0);const t=this.lines[this.index];if(t){const n=this.offset,r=t.length;return e>=r-n?(e=r-n,this.index+=1,this.offset=0):this.offset+=e,0===n&&e>=t.length?t:i.default.create(t.content.slice(n,e),t.attributes)}return i.default.create(new o.default([{retain:1/0}]))}peek(){return this.lines[this.index]}peekLength(){return this.lines[this.index]?this.lines[this.index].length-this.offset:1/0}rest(){if(this.hasNext()){if(0===this.offset)return this.lines.slice(this.index);{const e=this.offset,t=this.index,n=this.next(),r=this.lines.slice(this.index);return this.offset=e,this.index=t,[n].concat(r)}}return[]}}},6202:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(8220)),i=r(n(7026)),s=r(n(9419)),a={},c=new WeakMap;var u;!function(e){function t(e){return e.attributes.id}function n(e=a){let t;for(;e[t=Math.random().toString(36).slice(2)];);return t}e.iterator=function(e){return new i.default(e)},e.length=function(e){return e.length},e.getId=t,e.equal=function(e,t){return s.default(e.attributes,t.attributes)&&s.default(e.content.ops,t.content.ops)},e.fromDelta=function(t,n=a){const r=[];return t.eachLine(((t,o)=>{r.push(e.create(t,Object.keys(o).length?o:void 0,n))})),r},e.toDelta=function(e,t){let n=new o.default;return e.forEach((e=>{n=n.concat(e.content);let r=e.attributes;if(!t){const{id:e,...t}=r;r=t}n.insert("\n",r)})),n},e.create=function(e=new o.default,t={},r=a){const i=e.length()+1;return t.id||(t={...t,id:n(r)}),{attributes:t,content:e,length:i}},e.getLineInfo=function(e){let n=c.get(e);if(!n){const r=new Map,o={};let i=0;e.forEach((e=>{o[t(e)]=e,r.set(e,[i,i+=e.length])})),n={ranges:r,ids:o},c.set(e,n)}return n},e.createId=n}(u||(u={})),t.default=u},4980:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(7026)),i=r(n(3842)),s=r(n(6202)),a=r(n(139));var c;!function(e){e.iterator=function(e){return new u(e)},e.length=a.default.length}(c||(c={})),t.default=c;class u{constructor(e){this.lineIterator=new o.default(e);const t=this.lineIterator.peek();this.opsIterator=new i.default((null==t?void 0:t.content.ops)||[])}hasNext(){return this.opsIterator.hasNext()||this.lineIterator.hasNext()}skip(e){let t=0;for(;this.lineIterator.peekLength()<e;){const n=s.default.length(this.nextLine());e-=n,t+=n}return t}next(e){let t=this.opsIterator.next(e);if(t.retain===1/0){t={insert:"\n"};const e=this.nextLine();e.attributes&&(t.attributes=e.attributes)}return t}nextLine(){const e=this.lineIterator.next(),t=this.lineIterator.peek();return this.opsIterator=new i.default((null==t?void 0:t.content.ops)||[]),e}peek(){return this.opsIterator.peek()}peekLength(){return this.opsIterator.peekLength()}}},4199:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.hasFormat=void 0;const o=r(n(9801)),i=r(n(8220)),s=n(8374),a=r(n(6202)),c=r(n(4154)),u=r(n(9419));class l{constructor(e,t=new i.default,n){this._pos=0,this.doc=e,this.delta=t,this.selection=n}get contentChanged(){return this.delta.ops.length>0}get selectionChanged(){var e;return void 0!==this.selection&&!u.default(this.selection,null===(e=this.doc)||void 0===e?void 0:e.selection)}apply(){}setDelta(e){this.delta=e,this._pos=e.length()}select(e){return this.selection="number"==typeof e?[e,e]:e,this}delete(e,t){if(!e||!this.doc)return this;const[n,r]=s.normalizeRange(e);if(n===r)return this;const o=r-n;this.doc.selection&&(this.selection=[n,n]),this.compose(n,(e=>e.delete(o)),o);const i=this.doc.getLineRange(n);return!(null==t?void 0:t.dontFixNewline)&&i[1]<=r&&this.formatLine(r,this.doc.getLineFormat(n)),this}insert(e,t,n,r){if(!this.doc)return this;if(e=this.normalizePoint(e),this.doc.selection){const n=e+("string"==typeof t?t.length:1);this.selection=[n,n]}const o=this.doc.byId,i=this.doc.getLineFormat(e);if("string"!=typeof t)this.compose(e,(e=>e.insert(t,n)));else if("\n"===t)(null==r?void 0:r.dontFixNewline)?this.compose(e,(e=>e.insert("\n",{...n,id:a.default.createId(o)}))):(this.compose(e,(e=>e.insert("\n",i))),this.formatLine(e,{...n,id:a.default.createId(o)}));else{n||(n=this.getFormatAt(e));const r=t.split("\n");r.forEach(((t,r)=>{r&&this.compose(e,(e=>e.insert("\n",1===r?i:{id:a.default.createId(o)}))),t.length&&this.compose(e,(e=>e.insert(t,n)))})),r.length>1&&i&&this.formatLine(e,{...i,id:a.default.createId(o)})}return this}insertContent(e,t){return this.doc?(e=this.normalizePoint(e),this.compose(e,(e=>e.concat(t))),this):this}formatText(e,t){return this.doc&&(e=s.normalizeRange(e))[1]-e[0]?(t&&Object.keys(t).forEach((e=>!1===t[e]&&(t[e]=null))),this.doc.getLineRanges(e).forEach((([n,r])=>{n=Math.max(e[0],n);const o=(r=Math.min(e[1],r-1))-n;this.compose(n,(e=>e.retain(o,t)),o)})),this):this}toggleTextFormat(e,t){return this.doc?("number"==typeof e&&(e=[e,e]),e=s.normalizeRange(e),d(t,this.doc.getTextFormat(e))&&(t=o.default.invert(t)),this.formatText(e,t)):this}formatLine(e,t,n){if(!this.doc)return this;const r=this.doc;return"number"==typeof e&&(e=[e,e]),e=s.normalizeRange(e),this.doc.getLineRanges(e).forEach((([e,i])=>{if(i--,!n){const e=o.default.invert(r.getLineFormat(i));delete e.id,t={...e,...t}}this.compose(i,(e=>e.retain(1,t)),1)})),this}toggleLineFormat(e,t){return this.doc?("number"==typeof e&&(e=[e,e]),e=s.normalizeRange(e),d(t,this.doc.getLineFormat(e))&&(t=o.default.invert(t)),this.formatLine(e,t)):this}removeFormat(e){if(!this.doc)return this;e=s.normalizeRange(e);const t=o.default.invert(this.doc.getFormats(e)),n=e[1]-e[0];return this.compose(e[0],(e=>e.retain(n,t)),n)}transform(e,t){const n=this.delta.transform(e.delta,t),r=e.selection&&this.transformSelection(e.selection);return new l(null,n,r)}transformSelection(e,t){if(!e)return e;const n=this.delta.transformPosition(e[0],t),r=this.delta.transformPosition(e[1],t);return n===e[0]&&r===e[1]?e:[n,r]}transformAgainst(e,t){return(e instanceof i.default?new l(null,e):e).transform(this,!t)}isFor(e){return this.doc===e}clone(){var e;return new l(this.doc,new i.default(this.delta.ops.slice()),null===(e=this.selection)||void 0===e?void 0:e.slice())}compose(e,t,n){return this._pos<=e?this.delta=t(this.delta.retain(e-this._pos)):this.delta=this.delta.compose(t((new i.default).retain(e))),this._pos=Math.max(e+(n||0),this._pos),this}normalizePoint(e,t=(this.doc?this.doc.length-1:0)){return Math.max(0,Math.min(t,e))}getFormatAt(e){let t;if(this.doc){const n=this.doc.getTextFormat(e),r=this.doc.getTextFormat(e+1);n&&r&&(t=n===r?n:c.default(r,Object.keys(n)))}return t}}function d(e,t){return Object.keys(e).every((n=>t[n]===e[n]))}t.default=l,t.hasFormat=d},7415:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(9419)),i=r(n(8220)),s=r(n(139)),a=r(n(6202)),c=r(n(4980)),u=r(n(9801)),l=n(8374),d=r(n(4199)),f=[0,0],h={},p=new WeakMap,g=new WeakMap,m=new Set(["id"]);class y{constructor(e,t=null){Array.isArray(e)?this.lines=e:this.lines=e?a.default.fromDelta(e):[a.default.create()],this.lines.length||this.lines.push(a.default.create());const n=a.default.getLineInfo(this.lines);this._ranges=n.ranges,this.byId=n.ids,this.length=this.lines.reduce(((e,t)=>e+t.length),0),this.selection=t&&t.map((e=>Math.min(this.length-1,Math.max(0,e))))}get change(){const e=new d.default(this);return e.apply=()=>this.apply(e),e}getText(e){return e&&(e=l.normalizeRange(e)),(e?this.slice(e[0],e[1]):this.slice()).map((e=>"string"==typeof e.insert?e.insert:" ")).join("").slice(0,this.length-1)}getLineBy(e){return this.byId[e]}getLineAt(e){return this.lines.find((t=>{const[n,r]=this.getLineRange(t);return n<=e&&r>e}))}getLinesAt(e,t){let n=e;return Array.isArray(e)&&([e,n]=l.normalizeRange(e)),this.lines.filter((r=>{const[o,i]=this.getLineRange(r);return t?o>=e&&i<=n:o<=n&&i>e}))}getLineRange(e){const{lines:t,_ranges:n}=this;if("number"==typeof e){for(let r=0;r<t.length;r++){const o=n.get(t[r])||f;if(o[0]<=e&&o[1]>e)return o}return f}return"string"==typeof e&&(e=this.getLineBy(e)),n.get(e)}getLineRanges(e){return null==e?Array.from(this._ranges.values()):this.getLinesAt(e).map((e=>this.getLineRange(e)))}getLineFormat(e){let t=e;return Array.isArray(e)&&([e,t]=l.normalizeRange(e)),e===t&&t++,b(a.default,this.lines,e,t)}getTextFormat(e){let t=e;return Array.isArray(e)&&([e,t]=l.normalizeRange(e)),e===t&&e--,b(c.default,this.lines,e,t,(e=>"\n"!==e.insert))}getFormats(e){return{...this.getTextFormat(e),...this.getLineFormat(e)}}slice(e=0,t=1/0){const n=[],r=c.default.iterator(this.lines);let o=0;for(;o<t&&r.hasNext();){let i;o<e?i=r.next(e-o):(i=r.next(t-o),n.push(i)),o+=s.default.length(i)}return new i.default(n)}apply(e,t){let n;if(e instanceof d.default?(n=e.delta,t=e.selection):n=e,!n.ops.length&&(void 0===t||o.default(this.selection,t)))return this;if(!n.ops.length&&t)return new y(this.lines,t);void 0===t&&this.selection&&(t=[n.transformPosition(this.selection[0]),n.transformPosition(this.selection[1])],o.default(this.selection,t)&&(t=this.selection));const r=a.default.iterator(this.lines),c=s.default.iterator(n.ops);let u=[];const l=c.peek();if(l&&l.retain&&!l.attributes){let e=l.retain;for(;r.peekLength()<=e;)e-=r.peekLength(),u.push(r.next());l.retain-e>0&&c.next(l.retain-e)}0===c.index&&0===c.offset||(n=new i.default(c.rest()));const f=[];let h=n.reduce(((e,t)=>e+(t.insert?0:s.default.length(t))),0);for(;r.peekLength()<=h;)h-=r.peekLength(),f.push(r.next());h>=0&&f.push(r.next());const p=function(e,t,n){return a.default.fromDelta(a.default.toDelta(t,!0).compose(e,!0)).map((e=>{const t=a.default.getId(e),r=n[t];return r&&a.default.equal(r,e)?r:e}))}(n,f,this.byId);return p.length===f.length&&p.every(((e,t)=>e===f[t]))?this.selection===t?this:new y(this.lines,t):(u=u.concat(p),u=u.concat(r.rest()),new y(u,t))}replace(e,t){return new y(e,t)}toDelta(e){const t=e?g:p;let n=t.get(this);return n||(n=a.default.toDelta(this.lines,e),t.set(this,n)),n}equals(e,t){return this===e||((null==t?void 0:t.contentOnly)||o.default(this.selection,e.selection))&&o.default(this.lines,e.lines,{excludeProps:m})}toJSON(){return this.toDelta()}toString(){return this.lines.map((e=>e.content.map((e=>"string"==typeof e.insert?e.insert:" ")).join(""))).join("\n")+"\n"}}function b(e,t,n,r,o){const i=e.iterator(t);let s,a=0;for(i.skip&&(a+=i.skip(n));a<r&&i.hasNext();){let t=i.next();a+=e.length(t),a>n&&(!o||o(t))&&(t.attributes?s?s=v(s,t.attributes):(s={...t.attributes},s&&delete s.id):s={})}return s||h}function v(e,t){return Object.keys(t).reduce((function(n,r){return e[r]===t[r]&&(n[r]=e[r]),n}),{})}t.default=y,window.AttributeMap=u.default},3413:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Editor=t.TextDocument=t.TextChange=t.LineIterator=t.LineOp=t.Line=t.Op=t.OpIterator=t.Delta=t.AttributeMap=t.EventDispatcher=t.isEqual=t.intersect=t.cloneDeep=void 0;const s=i(n(6098));t.cloneDeep=s.default;const a=i(n(4154));t.intersect=a.default;const c=i(n(9419));t.isEqual=c.default;const u=i(n(7506));t.EventDispatcher=u.default;const l=i(n(9801));t.AttributeMap=l.default;const d=i(n(8220));t.Delta=d.default;const f=i(n(3842));t.OpIterator=f.default;const h=i(n(139));t.Op=h.default,o(n(8374),t);const p=i(n(6202));t.Line=p.default;const g=i(n(4980));t.LineOp=g.default;const m=i(n(7026));t.LineIterator=m.default;const y=i(n(4199));t.TextChange=y.default;const b=i(n(7415));t.TextDocument=b.default,o(n(930),t),o(n(1703),t),o(n(883),t),o(n(5658),t),o(n(1832),t),o(n(8173),t),o(n(9962),t),o(n(5046),t),o(n(7577),t),o(n(1081),t),o(n(185),t);const v=i(n(185));t.Editor=v.default},5513:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.copy=void 0;const o=n(8173),i=r(n(7415)),s=n(8374);t.copy=function(e){function t(t){t.preventDefault();const n=t.clipboardData,{doc:r}=e,{selection:a}=r;if(!r.selection)return;if(!n||!a)return;const c=s.normalizeRange(r.selection),u=r.slice(c[0],c[1]);if(!u.ops.length)return;const l=u.map((e=>"string"==typeof e.insert?e.insert:" ")).join("");let d;l.includes("\n")?(u.push({insert:"\n",attributes:r.getLineFormat(c[1])}),d=o.docToHTML(e,new i.default(u))):d=o.inlineToHTML(e,u),n.setData("text/plain",l),n.setData("text/html",d)}function n(n){t(n),e.delete()}return{init(){e.root.addEventListener("copy",t),e.root.addEventListener("cut",n)},destroy(){e.root.removeEventListener("copy",t),e.root.removeEventListener("cut",n)}}}},3797:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.applyDecorations=t.Decorator=t.decorations=t.DecorateEvent=void 0;const o=r(n(8220)),i=r(n(4199)),s=r(n(9419)),a=n(930),c=/;\s*$/,u={name:"decoration",selector:"span.format.decoration",fromDom:!1,render:(e,t)=>h(a.h("span",{},t),e,["format","decoration"])},l={name:"decoration",selector:".embed.decoration",fromDom:!1,noFill:!0,render:(e,t)=>{const n="embed decoration",{name:r,...o}=e.decoration;return o.class=o.class?n+" "+o.class:n,a.h(r||"span",o,t)}};class d extends Event{constructor(e,t){super(e,t),this.old=t.old,this.doc=t.doc,this.change=t.change,this.changedLines=t.changedLines}}t.DecorateEvent=d,t.decorations=function(e){e.typeset.formats.add(u),e.typeset.embeds.add(l);const t=new Map;let n=e.doc,r=n,o=n,i=!1;function a(s){var a,c;if(!s)throw new TypeError("A decoration name is required");const u=t.get(s);if(!u)return!1;const l=p(s,u,n);return t.delete(s),o=t.size?o.apply(l):n,i||(null===(a=e.modules.rendering)||void 0===a||a.render({old:r,doc:o}),null===(c=e.modules.selection)||void 0===c||c.renderSelection()),!0}function c(){t.size&&t.clear(),o=n}function h(a,c){var u,l;const d=t.get(a),f=d?d.compose(c,!0):c;s.default(f,d)||!d&&!f.ops.length||(f.ops.length?t.set(a,f):t.delete(a),o=t.size?o.apply(c,null):n,i||(null===(u=e.modules.rendering)||void 0===u||u.render({old:r,doc:o}),null===(l=e.modules.selection)||void 0===l||l.renderSelection()))}function g(e){const{change:r,changedLines:i}=e;if(n=e.doc,r){if(r.contentChanged){for(let[e,n]of t)n=r.delta.transform(n,!0),n.ops.length?t.set(e,n):t.delete(e);o=t.size?o.apply(r.delta,null):n}}else c();m(r,i)}function m(t,o){const s={old:r,doc:n,change:t,changedLines:o};i=!0,e.dispatchEvent(new d("decorate",s)),i=!1}function y(){r=o}return e.on("change",g),e.on("render",y),{get old(){return r},get doc(){return o},getDecorator:function(n){if(!n)throw new TypeError("A decoration name is required");const r=t.get(n);return new f(n,e.doc,r,h,a)},removeDecorations:a,clearDecorations:c,gatherDecorations:m,init(){m()},destroy(){e.off("change",g),e.off("render",y)}}};class f{constructor(e,t,n,r,o){this._name=e,this._doc=t,this.change=new i.default(t),this._decoration=n,this._apply=r,this._remove=o}hasDecorations(){return!!this._decoration&&this._decoration.ops.length>0||this.change.delta.ops.length>0}getDecoration(){return(this._decoration||new o.default).compose(this.change.delta)}apply(){return this._apply(this._name,this.change.delta)}remove(){return this._remove(this._name)}clear(e){return this.hasDecorations()?(e?this.change.setDelta(this.change.delta.compose(this.invert(e))):this.change.setDelta(this.invert()),this):this}clearLines(e){if(!e.length)return this;const t=this._doc,n=[t.getLineRange(e[0])[0],t.getLineRange(e[e.length-1])[1]];if(1===e.length||e.every(((n,r)=>!r||t.getLineRange(e[r-1])[1]===t.getLineRange(n)[0])))return this.clear(n);const r=this.invert(n),i=new o.default;let s=0;return e.forEach((e=>{const[n,o]=t.getLineRange(e);i.retain(n-s).concat(r.slice(n,o)),s=o})),this.change.setDelta(this.change.delta.compose(i)),this}clearLine(e){const t=this._doc,n="number"==typeof e?t.getLineAt(e):"string"==typeof e?t.byId[e]:e;return this.clearLines([n])}invert(e){return this._decoration?p(this._name,this._decoration,this._doc,e):new o.default}decorateText(e,t={class:this._name}){return this.change.formatText(e,{decoration:{[this._name]:t}}),this}decorateLine(e,t={class:this._name}){return this.change.formatLine(e,{decoration:{[this._name]:t}},!0),this}insertDecoration(e,t={class:this._name}){if("string"==typeof t)throw new Error("You may only insert embed decorations");return this.change.insert(e,{decoration:t}),this}}function h(e,t,n){if(!t||!t.decoration)return e;const r=new Set(n);let o="",i=e.props;Object.values(t.decoration).forEach((e=>{e.class&&r.add(e.class),e.style&&(o+=e.style),o&&!c.test(o)&&(o+=";"),i={...e,...i}}));return Array.from(r).join(" ").trim()&&i.class&&i.class,o&&(i.style=o),e.props=i,e}function p(e,t,n,r){let i=n.toDelta();return r&&(i=i.slice(r[0],r[1]),t=t.slice(r[0],r[1])),(t=t.invert(i)).ops.forEach((t=>{var n;null===(null===(n=t.attributes)||void 0===n?void 0:n.decoration)&&(t.attributes.decoration={[e]:null})})),r&&(t=(new o.default).retain(r[0]).concat(t)),t}t.Decorator=f,t.applyDecorations=h},9967:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultModules=void 0;const r=n(3797),o=n(7632),i=n(6900),s=n(6894),a=n(5683),c=n(4090),u=n(5513),l=n(3622);t.defaultModules={keyboard:i.keyboard,input:s.input,copy:u.copy,paste:c.paste,history:l.history,decorations:r.decorations,rendering:o.rendering,selection:a.selection}},3622:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.transformHistoryStack=t.undoStack=t.initHistory=t.history=void 0;const o=r(n(4199)),i=r(n(8220)),s=n(1081);function a(e={}){return function(t){let n=0,r="",i=!1,a={undo:[],redo:[]};const u={maxStack:500,delay:0,...e};function l(e){"historyUndo"===e.inputType?(e.preventDefault(),d()):"historyRedo"===e.inputType&&(e.preventDefault(),f())}function d(){y("undo","redo")}function f(){y("redo","undo")}function h(){return a.undo.length>0}function p(){return a.redo.length>0}function g(){n=0}function m(){a={undo:[],redo:[]}}function y(e,n){if(0===a[e].length)return;const r=a[e].pop();a[n].push(r),g(),i=!0,"function"==typeof r[e]?r[e]():t.update(r[e]),i=!1}function b({change:e,old:t,source:l}){return e?i?void 0:e.contentChanged?void(l===s.Source.user?function(e,t){const i=Date.now(),s=function(e){var t;const{ops:n}=e.delta;let r=0,o=n.length-1;if(n[r].retain&&!n[r].attributes&&r++,1===n[o].retain&&(null===(t=n[o].attributes)||void 0===t?void 0:t.id)&&o--,r===o){const e=n[r];if(e.delete)return"delete";if("\n"===e.insert)return"newline";if("string"==typeof e.insert)return"insert"}return""}(e);a.redo.length=0;const c=new o.default(null,e.delta.invert(t.toDelta()),t.selection);if(s&&r===s||g(),r=s,n&&(!u.delay||n+u.delay>i)&&a.undo.length){const t=a.undo[a.undo.length-1];t.redo.delta=t.redo.delta.compose(e.delta),t.redo.selection=e.selection,t.undo.delta=c.delta.compose(t.undo.delta)}else{const t=new o.default(null,e.delta,e.selection);n=i,a.undo.push({redo:t,undo:c})}a.undo.length>u.maxStack&&a.undo.shift()}(e,t):c(a,e)):g():m()}return{options:u,hasUndo:h,hasRedo:p,undo:d,redo:f,cutoffHistory:g,clearHistory:m,setStack:function(e){a=e},getStack:function(){return a},getActive:()=>({undo:h(),redo:p()}),commands:{undo:d,redo:f},shortcuts:{"win:Ctrl+Z":"undo","mac:Cmd+Z":"undo","win:Ctrl+Y":"redo","mac:Cmd+Shift+Z":"redo"},init(){t.on("change",b),t.root.addEventListener("beforeinput",l)},destroy(){t.off("change",b),t.root.removeEventListener("beforeinput",l)}}}}function c(e,t){const n=t instanceof i.default?new o.default(null,t):t;e.undo.forEach((e=>{e.undo=n.transform(e.undo,!0),e.redo=n.transform(e.redo,!0)})),e.redo.forEach((e=>{e.undo=n.transform(e.undo,!0),e.redo=n.transform(e.redo,!0)}))}t.history=a(),t.initHistory=a,t.undoStack=function(){return{undo:[],redo:[]}},t.transformHistoryStack=c},9962:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultModules=t.smartEntry=t.smartQuotes=t.placeholder=t.selection=t.rendering=t.copy=t.PasteEvent=t.paste=t.keyboard=t.input=t.undoStack=t.history=t.Decorator=t.DecorateEvent=t.decorations=void 0;var i=n(3797);Object.defineProperty(t,"decorations",{enumerable:!0,get:function(){return i.decorations}}),Object.defineProperty(t,"DecorateEvent",{enumerable:!0,get:function(){return i.DecorateEvent}}),Object.defineProperty(t,"Decorator",{enumerable:!0,get:function(){return i.Decorator}});var s=n(3622);Object.defineProperty(t,"history",{enumerable:!0,get:function(){return s.history}}),Object.defineProperty(t,"undoStack",{enumerable:!0,get:function(){return s.undoStack}});var a=n(6894);Object.defineProperty(t,"input",{enumerable:!0,get:function(){return a.input}}),o(n(4809),t);var c=n(6900);Object.defineProperty(t,"keyboard",{enumerable:!0,get:function(){return c.keyboard}});var u=n(4090);Object.defineProperty(t,"paste",{enumerable:!0,get:function(){return u.paste}}),Object.defineProperty(t,"PasteEvent",{enumerable:!0,get:function(){return u.PasteEvent}});var l=n(5513);Object.defineProperty(t,"copy",{enumerable:!0,get:function(){return l.copy}});var d=n(7632);Object.defineProperty(t,"rendering",{enumerable:!0,get:function(){return d.rendering}});var f=n(5683);Object.defineProperty(t,"selection",{enumerable:!0,get:function(){return f.selection}});var h=n(8055);Object.defineProperty(t,"placeholder",{enumerable:!0,get:function(){return h.placeholder}});var p=n(8580);Object.defineProperty(t,"smartQuotes",{enumerable:!0,get:function(){return p.smartQuotes}});var g=n(6361);Object.defineProperty(t,"smartEntry",{enumerable:!0,get:function(){return g.smartEntry}});var m=n(9967);Object.defineProperty(t,"defaultModules",{enumerable:!0,get:function(){return m.defaultModules}})},6894:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.input=void 0;const o=r(n(7529)),i=r(n(8220)),s=r(n(4199)),a=n(8173),c=n(1832),u=n(5658),l=n(883),d=n(8173),f={characterData:!0,characterDataOldValue:!0,subtree:!0,childList:!0};function h(e,t){for(;t&&t.parentNode!==e;)t=t.parentNode;return t}t.input=function(e){let t=!1;function n(n){if(n.isComposing||t)return;const o=r(function(e){const t=e.children,n=t.length;if(!n)return;if(1===n&&t[0].key)return[t[0],t[0]];return[t[t[0].key&&c.getLineNodeEnd(e,t[0])!==c.getLineNodeStart(e,t[1])?1:0],t[t[n-1].key&&c.getLineNodeEnd(e,t[n-2])!==c.getLineNodeStart(e,t[n-1])?n-2:n-1]]}(e.root));if(o&&o.ops.length){const t=u.getSelection(e);d.cleanText(o),e.update(new s.default(e.doc,o,t))}}function r(t){const{doc:n}=e;if(t){const[r,o]=t,s=c.getLineNodeStart(e.root,r),u=c.getLineNodeEnd(e.root,o),l=a.deltaFromDom(e,{startNode:r,endNode:o.nextElementSibling||void 0});let d=n.toDelta().slice(s,u).diff(l);return d.ops.length&&s&&(d=(new i.default).retain(s).concat(d)),d}{const t=a.deltaFromDom(e);return n.toDelta().diff(t)}}const p=new window.MutationObserver((function(n){if(t=!0,setTimeout((()=>t=!1)),!e.enabled)return e.render();let a=function(t){const n=function(e){const t=new Set;if((e=e.filter((e=>"characterData"!==e.type||!t.has(e.target)&&(t.add(e.target),!0)))).length>3)return null;const n=e.find((e=>"characterData"===e.type));if(!n)return null;const r=e.find((e=>1===e.addedNodes.length&&"#text"===e.addedNodes[0].nodeName));return 1+(r?1:0)+(e.find((e=>1===e.addedNodes.length&&"BR"===e.addedNodes[0].nodeName||1===e.removedNodes.length&&"BR"===e.removedNodes[0].nodeName))?1:0)<e.length||r&&r.addedNodes[0]!==n.target?null:n}(t);if(!n||null==n.oldValue||null==n.target.nodeValue)return null;const r=new i.default,s=l.getIndexFromNode(e,n.target);return r.retain(s),o.default(n.oldValue.replace(/\xA0/g," "),n.target.nodeValue.replace(/\xA0/g," ")).forEach((([t,n])=>{t===o.default.EQUAL?r.retain(n.length):t===o.default.DELETE?r.delete(n.length):t===o.default.INSERT&&r.insert(n,e.activeFormats)})),r.chop(),r}(n);const f=u.getSelection(e);a||(a=r(function(e,t){let n,r;for(let o=0;o<t.length;o++){const i=t[o];let s=h(e,i.target);if(!s&&i.nextSibling&&(s=h(e,i.nextSibling)),!s&&i.previousSibling&&(s=h(e,i.previousSibling)),s&&s.key)(!n||c.getLineNodeStart(e,s)<c.getLineNodeStart(e,n))&&(n=s),(!r||c.getLineNodeStart(e,s)>c.getLineNodeStart(e,r))&&(r=s);else if(i.target.key)return}if(n&&r)return[n,r]}(e.root,n))),a&&a.ops.length&&(d.cleanText(a),e.update(new s.default(e.doc,a,f)))}));function g(){p.disconnect()}function m(){p.observe(e.root,f)}return{init(){e.root.addEventListener("input",n),e.on("rendering",g),e.on("render",m)},destroy(){p.disconnect(),e.root.removeEventListener("input",n),e.off("rendering",g),e.off("render",m)}}}},6900:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboard=void 0;const r=n(4809),o=n(8374),i={};t.keyboard=function(e){function t(t){var n;if(t.isComposing)return;r.addShortcutsToEvent(t);const s=n=>{const r=e.shortcuts[n];if(r&&e.commands[r])return t.preventDefault(),!1!==e.commands[r]()};if(!s(t.shortcut)&&!s(t.osShortcut)&&!s(t.modShortcut)){switch(t.modShortcut){case"Enter":return function(t){if(t.defaultPrevented)return;t.preventDefault();const{typeset:{lines:n},doc:r}=e,{selection:o}=r;if(!o)return;const[s,a]=o,c=s===a,u=r.getLineAt(o[0]),[l,d]=r.getLineRange(o[0]);let f,h=u.attributes;const p=n.findByAttributes(h,!0),g=a===l,m=a===d-1;u.length-1||p===n.default||p.contained||p.defaultFollows||p.frozen||!c?(m&&(p.nextLineAttributes||p.defaultFollows||p.frozen)?h=p.nextLineAttributes?p.nextLineAttributes(h):i:g&&(p.defaultFollows&&(h=i),f={dontFixNewline:!0}),e.insert("\n",h,o,f)):e.formatLine(i)}(t);case"Shift+Enter":return function(t){if(t.defaultPrevented)return;t.preventDefault();const{typeset:n,doc:r}=e;n.embeds.get("br")&&r.selection&&e.insert({br:!0})}(t);case"Tab":case"Shift+Tab":case"Mod+]":case"Mod+[":return function(t){if(t.defaultPrevented)return;t.preventDefault();const n=t.modShortcut;"Tab"===n||"Mod+]"===n?e.indent():e.outdent()}(t)}switch(null===(n=t.modShortcut)||void 0===n?void 0:n.split("+").pop()){case"Backspace":return function(t){if(t.defaultPrevented)return;const{typeset:{lines:n},doc:r}=e,{selection:s}=r;if(!s)return;const a=s[0]===s[1],c=s[0],[u]=r.getLineRange(s[0]);if(!a||c===u)if(t.preventDefault(),s[0]+s[1]===0)l(r.getLineAt(s[0]),!0);else{const t=o.normalizeRange(s),i=r.getLineAt(t[0]),a=n.findByAttributes(i.attributes,!0);if(s[0]===s[1]&&s[0]===r.getLineRange(s[0])[0]&&!a.contained){if(l(r.getLineAt(s[0])))return;const n=r.lines[r.lines.indexOf(i)-1];if(n&&1===n.length&&1!==i.length)return e.update(e.change.delete([t[0]-2,t[1]-1]).select(t[0]-1))}e.delete(-1,{dontFixNewline:a.frozen})}function l(t,r){if(!t)return;const o=n.findByAttributes(t.attributes,!0);return o?o.indentable&&t.attributes.indent?(e.outdent(),!0):r||o!==n.default&&!o.defaultFollows?(e.formatLine(i),!0):void 0:void 0}}(t);case"Delete":return function(t){if(t.defaultPrevented)return;const{doc:n}=e,{selection:r}=n;if(!r)return;const i=r[0]===r[1],s=r[0],[a,c]=n.getLineRange(r[0]);if(i&&s!==c-1)return;let u;if(t.preventDefault(),r[0]===r[1]){const e=o.normalizeRange(r),t=n.getLineAt(e[0]),i=n.lines[n.lines.indexOf(t)-1];1===t.length&&i&&1!==i.length&&(u={dontFixNewline:!0})}e.delete(1,u)}(t);default:return}}}return{init(){e.root.addEventListener("keydown",t)},destroy(){e.root.removeEventListener("keydown",t)}}}},4090:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.paste=t.PasteEvent=void 0;const o=r(n(8220)),i=n(8173),s=r(n(6202)),a=n(8374),c=r(n(9419)),u={dontFixNewline:!0};class l extends Event{constructor(e,t){super(e,t),this.delta=t.delta}}function d(e){const{id:t,...n}=e.attributes;return n}t.PasteEvent=l,t.paste=function(e){function t(t){t.preventDefault();const n=t.clipboardData,{doc:r}=e,f=r.selection&&a.normalizeRange(r.selection);if(!n||!f)return;let h=f.slice();const p=n.getData("text/html");let g;if(p)g=i.deltaFromHTML(e,p,{possiblePartial:!0});else{let e=n.getData("text/plain");if(!e)return;g=(new o.default).insert(e)}if(g.filter((e=>"string"==typeof e.insert&&e.insert.includes("\n"))).length>0){let e=s.default.fromDelta(g,r.byId);g=s.default.toDelta(e);const t=r.getLineAt(h[0]),n=r.getLineAt(h[1]),i=d(t),a=t===n?i:d(n);p||(e=e.map((e=>({...e,attributes:t.attributes}))),i!==a&&(e[e.length-1].attributes=n.attributes));const u=e[0],l=d(u),f=e[e.length-1],m=u===f?l:d(f);c.default(i,l)||(g=(new o.default).insert("\n",i).concat(g)),c.default(a,m)&&(g=g.slice(0,g.length()-1))}const m=new l("paste",{delta:g,cancelable:!0});if(e.dispatchEvent(m),g=m.delta,!m.defaultPrevented&&g&&g.ops.length){const t=e.change.delete(h,u).insertContent(h[0],g).select(f[0]+g.length());e.update(t)}}return{init(){e.root.addEventListener("paste",t)},destroy(){e.root.removeEventListener("paste",t)}}}},8055:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.placeholder=void 0;const o=r(n(9419));t.placeholder=function(e,t){return n=>{function r({doc:r}){var i,s,a;const c=n.modules.decorations.getDecorator("placeholder"),u=("function"==typeof e?e():e)||"";let l;if(c.hasDecorations()){const e=c.getDecoration().ops;l=null===(s=null===(i=e[e.length-1].attributes)||void 0===i?void 0:i.decoration)||void 0===s?void 0:s.placeholder}const{lines:d}=n.typeset,f=d.findByAttributes(null===(a=r.lines[0])||void 0===a?void 0:a.attributes,!0),h=d.default===f&&1===r.length;if(h||(null==t?void 0:t.keepAttribute)){const e={"data-placeholder":u||""};h&&(e.class="placeholder"),o.default(e,l)||(c.remove(),c.decorateLine(0,e).apply())}else c.remove()}return n.addEventListener("decorate",r),{destroy(){n.removeEventListener("decorate",r)}}}}},7632:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rendering=void 0;const r=n(1832),o=n(5658);t.rendering=function(e){function t(t){const{doc:n,old:o}=e.modules.decorations||t;o.lines!==n.lines&&r.renderChanges(e,o,n)}return e.on("change",t),{render:function(t){if(t){const{doc:n,old:o}=t;o&&n?r.renderChanges(e,o,n):n&&r.render(e,n)}else{const{doc:t}=e.modules.decorations||e;r.render(e,t),o.setSelection(e,t.selection)}},destroy(){e.off("change",t)}}}},5683:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.selection=void 0;const o=r(n(9419)),i=n(5658),s=n(1832);t.selection=function(e){let t,n,r=!1;function a(){if(r)return;const t=i.getSelection(e),{doc:n}=e;if(o.default(n.selection,t))r=!0,setTimeout((()=>r=!1)),i.setSelection(e,t);else{if(t&&t[0]===t[1]&&t[0]>=n.length)return;e.select(t)}}function c(){r||i.setSelection(e,e.doc.selection)}function u(){const{doc:t,typeset:{lines:n}}=e,r=e.modules.decorations.getDecorator("selection");r.clear();const o=t.selection;o&&t.getLinesAt(o).forEach((e=>{if(1===e.length&&n.findByAttributes(e.attributes,!0).frozen){const n=o[0]===o[1];r.decorateLine(t.getLineRange(e)[0],{class:"selected"+(n?" focus":"")})}})),r.apply()}function l(t){const n=s.getLineNodeStart(e.root,t.target),r=null!=n&&e.doc.getLineAt(n),o=r&&e.typeset.lines.findByAttributes(r.attributes);null!=n&&r&&1===r.length&&o&&o.frozen&&(t.preventDefault(),e.select(n))}function d(t){var n;const o=(null===(n=t.doc)||void 0===n?void 0:n.selection)||e.doc.selection;r=!0,setTimeout((()=>r=!1)),i.setSelection(e,o)}function f(){e.root.classList.toggle("window-inactive",!t.hasFocus())}return{pause:function(){r=!0;const{selection:t}=e.doc,{decorations:n}=e.modules;t&&t[0]!==t[1]&&n&&n.getDecorator("pausedSelection").decorateText(t,{class:"selected"}).apply()},resume:function(){r=!1;const{decorations:t}=e.modules;t&&t.removeDecorations("pausedSelection"),setTimeout(c)},renderSelection:c,init(){t=e.root.ownerDocument,n=t.defaultView,t.addEventListener("selectionchange",a),n.addEventListener("focus",f),n.addEventListener("blur",f),e.root.addEventListener("mousedown",l),e.on("change",d),e.on("decorate",u)},destroy(){t.removeEventListener("selectionchange",a),n.removeEventListener("focus",f),n.removeEventListener("blur",f),e.root.addEventListener("mousedown",l),e.off("change",d),e.off("decorate",u),r=!1,t=null,n=null}}}},4809:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shortcutFromEvent=t.addShortcutsToEvent=void 0;const n={Control:!0,Meta:!0,Shift:!0,Alt:!0},r=-1!==navigator.userAgent.indexOf("Macintosh"),o=r?/Cmd/:/Ctrl/;function i(e){const t=[];let o=e.key;return o?(" "===o&&(o="Space"),e.metaKey&&t.push("Cmd"),e.ctrlKey&&t.push("Ctrl"),e.altKey&&t.push("Alt"),e.shiftKey&&t.push("Shift"),n[o]||(r&&e.altKey&&e.code&&e.code.startsWith("Key")&&(o=e.code.replace("Key","")),1===o.length&&(o=o.toUpperCase()),t.push(o)),t.join("+")):""}t.addShortcutsToEvent=function(e){return e.shortcut=i(e),e.osShortcut=`${r?"mac":"win"}:${e.shortcut}`,e.modShortcut=e.shortcut.replace(o,"Mod"),e},t.shortcutFromEvent=i},6361:(e,t)=>{"use strict";function n(e,n,r){return t.lineReplacements.some((([t,o])=>{const i=r.match(t);if(i){const t=o(i[1]);if(!e.typeset.lines.findByAttributes(t))return!1;const s=n-r.length,a=e.change.delete([s,n]).formatLine(n,t).select([s,s]);return e.update(a),!0}return!1}))}function r(e,n,r){return t.linkReplacements.some((([t,o])=>{const i=r.match(t);if(i){let t=i[0].slice(0,-1);"."===t[t.length-1]&&(t=t.slice(0,-1));const r=n-(i[0].length-t.length),s=o(t);return!!e.typeset.formats.findByAttributes(s)&&(e.formatText(s,[r-t.length,r]),!0)}return!1}))}function o(e,n,r){return t.textReplacements.some((([t,o])=>{const i=r.match(t);return!!i&&(e.insert(o(i[1]),void 0,[n-i[0].length,n]),!0)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.smartEntry=t.defaultHandlers=t.textReplace=t.markReplace=t.linkReplace=t.lineReplace=t.textReplacements=t.linkReplacements=t.markReplacements=t.lineReplacements=void 0,t.lineReplacements=[[/^(#{1,6}) $/,e=>({header:e.length})],[/^[-*] $/,()=>({list:"bullet"})],[/^1\. $/,()=>({list:"ordered"})],[/^([AaIi])\. $/,e=>({list:"ordered",type:e})],[/^(-?\d+)\. $/,e=>({list:"ordered",start:e})],[/^([A-Z])\. $/,e=>({list:"ordered",type:"A",start:e.charCodeAt(0)-"A".charCodeAt(0)+1})],[/^([a-z])\. $/,e=>({list:"ordered",type:"a",start:e.charCodeAt(0)-"a".charCodeAt(0)+1})],[/^([IVXLCDM]+)\. $/i,e=>({list:"ordered",type:e[0].toUpperCase()===e[0]?"I":"i",start:s(e)})],[/^> $/,()=>({blockquote:!0})]],t.markReplacements=[[/(\*|_){3}(\b(?:(?!\1).)+\b)\1{3}((?:(?!\1).))$/s,()=>({bold:!0,italic:!0})],[/(\*|_){2}(\b(?:(?!\1).)+\b)\1{2}((?:(?!\1).))$/s,()=>({bold:!0})],[/(\*|_){1}(\b(?:(?!\1).)+\b)\1{1}((?:(?!\1).))$/s,()=>({italic:!0})]],t.linkReplacements=[[/(https?:\/\/.)[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b[-a-zA-Z0-9@:%_+.~#?&/=]*\s$/s,e=>({link:e})],[/(www\.)[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b[-a-zA-Z0-9@:%_+.~#?&/=]*\s$/s,e=>({link:"https://"+e})],[/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.(com|org|net|io)\b[-a-zA-Z0-9@:%_+.~#?&/=]*\s$/s,e=>({link:"https://"+e})]],t.textReplacements=[[/--$/,()=>"—"],[/\.\.\.$/,()=>"…"]],t.lineReplace=n,t.linkReplace=r,t.markReplace=function(e,n,r,o){return t.markReplacements.some((([t,i])=>{const s=r.match(t);if(s){let[t,r,a,c]=s;const u=i(a);if(!e.typeset.formats.findByAttributes(u))return!1;t.length,a.length,c.length," "===c&&" "===o[n]&&(c="");const l=n-c.length;return e.insert(a,u,[l-t.length+c.length,l]),!0}return!1}))},t.textReplace=o,t.defaultHandlers=[n,o,r],t.smartEntry=function(e=t.defaultHandlers){return t=>{let n=!1;function r({change:r,source:o}){if(n||"user"!==o||!t.doc.selection||!r||!function(e){return(1===e.ops.length||2===e.ops.length&&e.ops[0].retain&&!e.ops[0].attributes)&&e.ops[e.ops.length-1].insert}(r.delta))return;const i=t.doc.selection[1],s=t.doc.getText(),a=s.lastIndexOf("\n",i-2)+1,c=s.slice(a,i);n=!0,e.some((e=>e(t,i,c,s))),n=!1}return t.on("change",r),{destroy(){t.off("change",r)}}}};const i={I:1,V:5,X:10,L:50,C:100,D:500,M:1e3};function s(e){e=e.toUpperCase();let t=0;for(let n=0;n<e.length;n++){const r=i[e[n]],o=i[e[n+1]];if(void 0===r)return;r<o?(t+=o-r,n++):t+=r}return t}},8580:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.smartQuotes=void 0;const o=r(n(8220)),i=/['"]/g,s=/[\s\{\[\(\<'"\u2018\u201C]/,a={'"':{left:"“",right:"”"},"'":{left:"‘",right:"’"}};t.smartQuotes=function(e){function t(e){const{change:t,source:n,doc:r,old:c}=e;if("user"!==n||!c.selection||!t)return;const u=function(e){const t=[];let n=0;return e.forEach((e=>{if(e.retain&&(n+=e.retain),e.delete&&(n-=e.delete),"string"==typeof e.insert){let r;for(;r=i.exec(e.insert);)t.push(n+r.index);n+=e.insert.length}})),t}(t.delta.ops);if(!u.length)return;const l=r.getText(),d=new o.default;let f=0;for(let e=0;e<u.length;e++){const t=u[e],n=l[t],r=!t||s.test(l[t-1])?a[n].left:a[n].right;d.retain(t-f).delete(1).insert(r),f=t+1}e.modify(d)}return e.on("changing",t),{destroy(){e.off("changing",t)}}}},9260:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBRPlaceholder=void 0;const r=n(141);NodeFilter.SHOW_TEXT,NodeFilter.SHOW_ELEMENT,t.isBRPlaceholder=function(e,t){return"BR"===t.nodeName&&function(e,t){const n=t.closest&&t.closest(e.typeset.lines.selector);if(!n)return!1;const o=r.createTreeWalker(n);return o.currentNode=t,!o.nextNode()}(e,t)}},5043:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escapeHtml=void 0;const n=/["'&<>]/;t.escapeHtml=function(e){var t,r=""+e,o=n.exec(r);if(!o)return r;var i="",s=0,a=0;for(s=o.index;s<r.length;s++){switch(r.charCodeAt(s)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}a!==s&&(i+=r.substring(a,s)),a=s+1,i+=t}return a!==s?i+r.substring(a,s):i}},8173:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deltaFromDom=t.cleanText=t.docFromDom=t.deltaFromHTML=t.docFromHTML=t.inlineToHTML=t.docToHTML=void 0;const o=n(5043),i=n(9260),s=r(n(7415)),a=n(1832),c=n(141),u=r(n(8220)),l=n(1832),d=/[\0-\x09\x0B\x1F\x7F-\x9F\xAD\u0600-\u0605\u061C\u06DD\u070F\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB\uE000-\uF8FF]/g,f={STYLE:!0,SCRIPT:!0,LINK:!0,META:!0,TITLE:!0},h={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},p=/[ \t\n\r]+/g,g=document.createElement("div"),m={};function y(e,t,n){const r=v(e,{root:(new window.DOMParser).parseFromString(t,"text/html").body,possiblePartial:n&&n.possiblePartial});return b(r),r}function b(e){e.forEach((e=>{"string"==typeof e.insert&&(e.insert=e.insert.replace(d,""))}))}function v(e,t=m){const{lines:n,embeds:r}=e.typeset,o=t.root||e.root;var s=c.createTreeWalker(o,(e=>!f[e.nodeName]));const a=new u.default;let l,d,h=!1,g=!1,y=!0;for(t.startNode?(s.currentNode=t.startNode,s.previousNode(),t.offset&&a.retain(t.offset,void 0)):s.currentNode=o;(d=s.nextNode())&&d!==t.endNode;)if(i.isBRPlaceholder(e,d))y=!1;else if("BR"===d.nodeName&&"Apple-interchange-newline"===d.className)a.insert("\n",!l||l.unknownLine?{}:l);else if(d.nodeType===Node.TEXT_NODE){let t=d.parentNode;if(null==d.nodeValue||""===d.nodeValue.replace(/\n+/g,""))continue;if(!d.nodeValue.replace(/\s+/g,"")&&(d.parentNode===o||d.previousSibling&&n.matches(d.previousSibling)||d.nextSibling&&n.matches(d.nextSibling)))continue;const r=d.nodeValue.replace(p," ").replace(/\xA0/g," ");if(!r||" "===r&&t.classList.contains("EOP"))continue;const i=_(t,o,e);y=!1,a.insert(r,i)}else if(r.matches(d)){const t=r.findByNode(d);if(t){const n=_(d.parentNode,o,e);!1!==t.fromDom&&a.insert(t.fromDom?t.fromDom(d):{[t.name]:!0},n)}}else if(n.matches(d)||d.nodeType===Node.ELEMENT_NODE&&d.matches("address, article, aside, blockquote, editor, dd, div, dl, dt, fieldset, figcaption, figure, footer, form, header, hr, li, main, nav, noscript, ol, output, p, pre, section, table, tfoot, ul, video")){if(g=!n.matches(d),g){let e=d.parentNode;for(;e&&!n.matches(e)&&e!==o;)e=e.parentNode;if(e&&e!==o)continue}const e=n.findByNode(d,!0);if(e===n.default&&(!d.parentNode||n.matches(d.parentNode)))continue;h?l&&l.unknownLine&&y||(a.insert("\n",!l||l.unknownLine?{}:l),y=!0):h=!0,l=g?{unknownLine:g}:e&&e!==n.default?e.fromDom?e.fromDom(d):{[e.name]:!0}:{}}return g&&y||!h&&t.possiblePartial||a.insert("\n",!l||l.unknownLine?{}:l),a}function w(e){return e&&e.length?e.reduce(((e,t)=>e+("string"!=typeof t?function(e){if("string"==typeof e){g.textContent=e;const t=g.innerHTML;return g.textContent="",t}const t=Object.keys(e.props).reduce(((t,n)=>"key"===n?t:`${t} ${o.escapeHtml(n)}="${o.escapeHtml(e.props[n])}"`),""),n=w(e.children),r=n||!h[e.type]?`</${e.type}>`:"";return`<${e.type}${t}>${n}${r}`}(t):o.escapeHtml(t).replace(/\xA0/g,"&nbsp;"))),""):""}function _(e,t,n){const{lines:r,formats:o}=n.typeset,i={};for(;e&&!r.matches(e)&&e!==t;){if(o.matches(e)){const t=o.findByNode(e);t&&!1!==t.fromDom&&(i[t.name]=!t.fromDom||t.fromDom(e))}else e.hasAttribute("style")&&o.list.forEach((t=>{t.styleSelector&&e.matches(t.styleSelector)&&(i[t.name]=!t.fromDom||t.fromDom(e))}));e=e.parentNode}return i}t.docToHTML=function(e,t){return w(l.renderDoc(e,t))},t.inlineToHTML=function(e,t){return w(a.renderInline(e,t))},t.docFromHTML=function(e,t,n){return new s.default(y(e,t),n)},t.deltaFromHTML=y,t.docFromDom=function(e,t){return new s.default(v(e,{root:t}))},t.cleanText=b,t.deltaFromDom=v},883:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textNodeLength=t.getNodeAndOffset=t.getNodesForRange=t.getNodeLength=t.getLineElementAt=t.getIndexFromNode=t.getIndexFromNodeAndOffset=t.getBoudingBrowserRange=t.getBrowserRange=t.getIndexFromPoint=void 0;const r=n(1832),o=n(9260),i=n(141),s=[null,0];function a(e,t){t[0]>t[1]&&(t=[t[1],t[0]]);const[n,r,o,i]=f(e,t),s=e.root.ownerDocument.createRange();return n&&o&&(s.setStart(n,r),s.setEnd(o,i)),s}function c(e,t,n,o){const{root:i}=e;if(!i.contains(t))return-1;if(t.nodeType===Node.ELEMENT_NODE){if(t.childNodes.length===n){if(null!=r.getLineNodeEnd(i,t))return r.getLineNodeEnd(i,t)-1;t.childNodes.length&&(n=d(e,t=t.childNodes[n-1]))}else t=t.childNodes[n],n=0;const s=r.getLineNodeStart(i,t);if(null!=s)return(null==o||o<s?s:s-1)+n}return u(e,t)+n}function u(e,t){var n;const{root:s}=e;if(!s.ownerDocument)return-1;const{lines:a,embeds:c}=e.typeset,u=i.createTreeWalker(s);let l;u.currentNode=t;let d,f=0;for(;(l=u.previousNode())&&l!==s;){if(null!=(d=r.getLineNodeStart(s,l))){f+=d;break}l.nodeType===Node.TEXT_NODE?f+=p(a,l):(null===(n=l.classList)||void 0===n?void 0:n.contains("decoration"))||(c.matches(l)&&!o.isBRPlaceholder(e,l)||a.matches(l))&&f++}return f}function l(e,t){const{root:n}=e;if(n.ownerDocument)return Array.from(n.childNodes).find((e=>r.getLineNodeStart(n,e)<=t&&r.getLineNodeEnd(n,e)>t))}function d(e,t){var n;const{lines:r,embeds:s}=e.typeset;if(s.matches(t)&&!o.isBRPlaceholder(e,t))return 1;const a=i.createTreeWalker(t);let c,u=r.findByNode(t)?1:0;for(;c=a.nextNode();)c.nodeType===Node.TEXT_NODE?u+=p(r,c):(null===(n=c.classList)||void 0===n?void 0:n.contains("decoration"))||(s.matches(c)&&!o.isBRPlaceholder(e,c)||r.matches(c))&&u++;return u}function f(e,t){if(null==t)return[null,0,null,0];{const n=t[0]<=t[1],[r,o,i]=h(e,t[0],n?0:1),[s,a]=t[0]===t[1]?i?[r,o+(n?1:-1)]:[r,o]:h(e,t[1],n?1:0);return[r,o,s,a]}}function h(e,t,n){var a;const{root:c}=e;if(!c.ownerDocument)return s;const{lines:u,embeds:d}=e.typeset,f=Array.from(c.childNodes),h=l(e,t);if(!h)return s;if(u.findByNode(h,!0).frozen)return[h.parentNode,f.indexOf(h)+n,!0];const g=!(t-=r.getLineNodeStart(c,h)),m=i.createTreeWalker(h);let y,b=!1;for(;y=m.nextNode();)if(y.nodeType===Node.TEXT_NODE){const e=p(u,y);if(t<=e)return[y,t];t-=e}else if(null===(a=y.classList)||void 0===a?void 0:a.contains("decoration"));else if(d.matches(y)&&!o.isBRPlaceholder(e,y)){const e=d.findByNode(y);if(!e||!1===e.fromDom)continue;if((t-=1)<=0){const e=Array.from(y.parentNode.childNodes);return[y.parentNode,e.indexOf(y)+1+t]}}else if(u.matches(y)&&(b?t-=1:b=!0,0===t)){const e=m.firstChild();return e&&e.nodeType===Node.TEXT_NODE?[e,0]:e?[y,Array.from(y.childNodes).indexOf(e)]:[y,0]}return g?[h,0]:s}function p(e,t){const n=t.nodeValue||"";return n.trim()||!e.matches(t.previousSibling)&&!e.matches(t.nextSibling)?n.length:0}t.getIndexFromPoint=function(e,t,n){const r=e.root.ownerDocument;if(r.caretPositionFromPoint)try{const o=r.caretPositionFromPoint(t,n);if(o)return c(e,o.offsetNode,o.offset)}catch(e){}if(r.caretRangeFromPoint){const o=r.caretRangeFromPoint(t,n);if(o)return c(e,o.startContainer,o.startOffset)}return null},t.getBrowserRange=a,t.getBoudingBrowserRange=function(e,t){const n=a(e,t);if((null==n?void 0:n.endContainer.nodeType)===Node.ELEMENT_NODE)try{n.setEnd(n.endContainer,n.endOffset+1)}catch(e){}return n},t.getIndexFromNodeAndOffset=c,t.getIndexFromNode=u,t.getLineElementAt=l,t.getNodeLength=d,t.getNodesForRange=f,t.getNodeAndOffset=h,t.textNodeLength=p},1832:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderInline=t.getChangedRanges=t.combineLines=t.renderMultiLine=t.renderSingleLine=t.renderLine=t.renderCombined=t.renderDoc=t.fromNode=t.renderChanges=t.render=t.setLineNodesRanges=t.getLineNodeEnd=t.getLineNodeStart=void 0;const o=r(n(9419)),i=n(930),s=r(n(6202)),a=n(8173),c=n(3797),u=[],l=i.h("br",{}),d=new WeakMap,f=new WeakMap,h=new WeakMap,p=new WeakMap,g=new WeakMap;function m(e){const{root:t,doc:n}=e,r=x(e,n.lines),o=new WeakMap;for(let i=0;i<t.children.length;i++){const s=t.children[i];if(!s.key)continue;const a=r.byKey[s.key];if(a)if(Array.isArray(a)){o.set(s,[n.getLineRange(a[0])[0],n.getLineRange(a[a.length-1])[1]]);const t=s.querySelectorAll(e.typeset.lines.selector);for(let e=0;e<t.length;e++){const r=t[e],i=n.byId[r.key];i&&o.set(r,n.getLineRange(i))}}else o.set(s,n.getLineRange(a))}const i=t.querySelectorAll(e.typeset.lines.selector);for(let e=0;e<i.length;e++){const t=i[e];if(o.has(t)||!t.key)continue;const r=n.byId[t.key];o.set(t,n.getLineRange(r))}g.set(t,o)}function y(e,t){const{root:n}=e;e.dispatchEvent(new Event("rendering")),i.patch(n,b(e,t)),m(e),e.dispatchEvent(new Event("render")),e.dispatchEvent(new Event("rendered"))}function b(e,t){return v(e,x(e,t.lines).combined)}function v(e,t){return t.map((t=>w(e,t))).filter(Boolean)}function w(e,t){return Array.isArray(t)?E(e,t):_(e,t)}function _(e,t){const n=T(e,t);if(!n.render)throw new Error("No render method defined for line");const r=n.render(t.attributes,O(e,t.content),e);return c.applyDecorations(r,t.attributes),r.key=t.attributes.id,r}function E(e,t){const n=T(e,t[0]);if(!n.renderMultiple)throw new Error("No render method defined for line");const r=n.renderMultiple(t.map((t=>[t.attributes,O(e,t.content)])),e);return r.key=t[0].attributes.id,r}function x(e,t){const n=p.get(t);if(n)return n;const r=[],o={};let i=[];t.forEach(((n,a)=>{const c=T(e,n);if(c.shouldCombine){i.push(n);const u=t[a+1];if(!u||T(e,u)!==c||!c.shouldCombine(n.attributes,u.attributes)){const e=h.get(i[0]);e&&e.length===i.length&&i.every(((t,n)=>e[n]===t))?i=e:h.set(i[0],i),r.push(i),o[s.default.getId(i[0])]=i,i=[]}}else c.render&&(r.push(n),o[s.default.getId(n)]=n)}));const a={combined:r,byKey:o};return p.set(t,a),a}function k(e,t){const n=e.length,r=t.length,o=Math.min(n,r);let i=0,s=0,a=0,c=0;for(let n=0;n<o;n++)if(!S(e[n],t[n])){i=a=n;break}for(let i=0;i<o;i++)if(!S(e[n-i-1],t[r-i-1])){const e=Math.max(i-1,0);s=n-e,c=r-e;break}return[[i,s],[a,c]]}function O(e,t){const{formats:n,embeds:r}=e.typeset;let o=[],i=!0;return t.ops.forEach(((t,s,a)=>{let c=[];if("string"==typeof t.insert){const e=a[s-1];let n=t.insert.replace(/  /g,"  ").replace(/  /g,"  ");e&&"object"!=typeof e.insert||(n=n.replace(/^ /," ")),n=n.replace(/ $/," "),i=!1,c.push(n)}else if(t.insert){const n=r.findByAttributes(t.insert);(null==n?void 0:n.render)&&(c.push(n.render(t.insert,u,e)),"br"===n.name?i=!0:n.noFill||(i=!1))}t.attributes&&Object.keys(t.attributes).sort(((e,t)=>n.priority(t)-n.priority(e))).forEach((r=>{const o=n.get(r);if(null==o?void 0:o.render){const n=o.render(t.attributes,c,e);d.set(n,o),c=[n]}})),o.push.apply(o,c)})),o=L(o),i&&o.push(l),o}function S(e,t){return e===t||Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every(((e,n)=>e===t[n]))}function T(e,t){let n=f.get(t.attributes);return n||(n=e.typeset.lines.findByAttributes(t.attributes,!0),f.set(t.attributes,n)),n}function L(e){const t=[];if(e.forEach(((e,n)=>{let r=t[t.length-1];r&&"string"!=typeof r&&"string"!=typeof e&&d.has(r)&&d.get(r)===d.get(e)&&o.default(r.props,e.props)?r.children=r.children.concat(e.children):r&&"string"==typeof r&&"string"==typeof e?r+=e:(t.push(e),r&&"string"!=typeof r&&r.children&&(r.children=L(r.children)))})),t.length){const e=t[t.length-1];e&&"string"!=typeof e&&e.children&&(e.children=L(e.children))}return t}window.nodeRanges=g,t.getLineNodeStart=function(e,t){var n,r;return null===(r=null===(n=g.get(e))||void 0===n?void 0:n.get(t))||void 0===r?void 0:r[0]},t.getLineNodeEnd=function(e,t){var n,r;return null===(r=null===(n=g.get(e))||void 0===n?void 0:n.get(t))||void 0===r?void 0:r[1]},t.setLineNodesRanges=m,t.render=y,t.renderChanges=function(e,t,n){const{root:r}=e,o=x(e,t.lines).combined,s=x(e,n.lines).combined,[a,c]=k(o,s),u=Array.from(r.childNodes).slice(a[0],a[1]),l=s.slice(c[0],c[1]);if(!u.length&&!l.length)return y(e,n);e.dispatchEvent(new Event("rendering")),i.patch(r,v(e,l),u,u.length?void 0:r.children[a[1]]),m(e),e.dispatchEvent(new Event("render")),e.dispatchEvent(new Event("rendered"))},t.fromNode=function(e,t){const n=s.default.fromDelta(a.deltaFromDom(e,{root:t}));if(n.length)return e.typeset.lines.findByAttributes(n[0].attributes,!0).renderMultiple?n:n[0]},t.renderDoc=b,t.renderCombined=v,t.renderLine=w,t.renderSingleLine=_,t.renderMultiLine=E,t.combineLines=x,t.getChangedRanges=k,t.renderInline=O},5658:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSelection=t.getSelection=void 0;const r=n(883);t.getSelection=function(e){const{root:t}=e,n=e.doc.selection;if(!t.ownerDocument)return null;const o=t.ownerDocument.getSelection();if(null!=o&&null!=o.anchorNode&&null!=o.focusNode&&t.contains(o.anchorNode)){const t=r.getIndexFromNodeAndOffset(e,o.anchorNode,o.anchorOffset,n&&n[0]);return[t,o.anchorNode===o.focusNode&&o.anchorOffset===o.focusOffset?t:r.getIndexFromNodeAndOffset(e,o.focusNode,o.focusOffset,n&&n[1])]}return null},t.setSelection=function(e,t){const{root:n}=e;if(!n.ownerDocument)return;const o=n.ownerDocument.getSelection();if(!o)return;const i=o.anchorNode&&n.contains(o.anchorNode)&&document.activeElement!==document.body;if(null==t)i&&(o.removeAllRanges(),n.classList.remove("focus"));else{const[s,a,c,u]=r.getNodesForRange(e,t),l=t[0]===t[1]?"Caret":"Range";s&&c&&(o.anchorNode===s&&o.anchorOffset===a&&o.focusNode===c&&o.focusOffset===u&&o.type===l||o.setBaseAndExtent(s,a,c,u)),i||n.focus(),n.classList.add("focus")}n.dispatchEvent(new Event("select",{bubbles:!0}))}},930:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.patch=t.React=t.h=t.recycleNode=void 0;const n=[],r=new Set(["value","selected","checked","contentEditable"]),o=e=>null==e?e:e.key,i=(e,t)=>{t&&t!==e.key&&(e.key=t),!t&&e.key&&delete e.key},s=e=>{e.currentTarget.events[e.type](e)},a=(e,t,n,r,o)=>{"key"===t||("o"===t[0]&&"n"===t[1]?((e.events||(e.events={}))[t=t.slice(2)]=r)?n||e.addEventListener(t,s):e.removeEventListener(t,s):null==r?e.removeAttribute(t):!o&&"list"!==t&&"form"!==t&&t in e?e[t]=null==r?"":r:e.setAttribute(t,r))},c=(e,t)=>{if("string"==typeof e)return document.createTextNode(e);var n=e.props,r=(t=t||"svg"===e.type)?document.createElementNS("http://www.w3.org/2000/svg",e.type,{is:n.is}):document.createElement(e.type,{is:n.is});for(var s in n)a(r,s,null,n[s],t);return i(r,o(e)),e.children.forEach((e=>r.appendChild(c(f(e),t)))),r},u=(e,t)=>{const n={};for(let r=0;r<e.attributes.length;r++){const{name:o,value:i}=e.attributes[r];n[o]=o in e&&"list"!==o&&!t?e[o]:""===i||i}return n},l=(e,t,n,o,s)=>{if("string"==typeof o)null!=n&&n.nodeType===Node.TEXT_NODE?n.nodeValue!==o&&(t.nodeValue=o):(t=e.insertBefore(c(o,s),t),null!=n&&e.removeChild(n));else if(null==n||n.nodeName.toLowerCase()!==o.type)t=e.insertBefore(c(f(o),s),t),null!=n&&e.removeChild(n);else{var l=u(n,s),h=o.props;for(var p in s=s||"svg"===o.type,{...l,...h})(r.has(p)?t[p]:l[p])!==h[p]&&a(t,p,l[p],h[p],s);i(t,o.key),d(t,o.children,s)}return t},d=(e,t,n,r=Array.from(e.childNodes),i)=>{for(var s,a,u,d,h=0,p=0,g=r.length-1,m=t.length-1;p<=m&&h<=g&&null!=(u=o(r[h]))&&u===o(t[p]);)l(e,r[h],r[h++],t[p]=f(t[p++]),n);for(;p<=m&&h<=g&&null!=(u=o(r[g]))&&u===o(t[m]);)r[g]=l(e,r[g],r[g--],t[m]=f(t[m--]),n);if(h>g){const o=r[h]||r[h-1]&&r[h-1].nextSibling||i;for(;p<=m;)e.insertBefore(c(t[p]=f(t[p++]),n),o)}else if(p>m)for(;h<=g;)e.removeChild(r[h++]);else{const i=new Map,c=new Set;for(let e=h;e<=g;e++)null!=(u=o(r[e]))&&i.set(u,r[e]);for(;p<=m;)u=o(a=r[h]),d=o(t[p]=f(t[p])),c.has(u)||null!=d&&d===o(r[h+1])?(null==u&&e.removeChild(a),h++):null==d?(null==u&&(l(e,a,a,t[p],n),p++),h++):(u===d?(l(e,a,a,t[p],n),c.add(d),h++):null!=(s=i.get(d))?(l(e,e.insertBefore(s,a),s,t[p],n),c.add(d)):l(e,a,null,t[p],n),p++);for(;h<=g;)null==o(a=r[h++])&&e.removeChild(a);for(const[t,n]of i)c.has(t)||e.removeChild(n)}return e},f=e=>!0!==e&&!1!==e&&e?e:"",h=(e,t,n,r)=>({type:e,props:t,children:n,key:r});t.recycleNode=e=>e.nodeType===Node.TEXT_NODE?e.nodeValue:h(e.nodeName.toLowerCase(),u(e),n.map.call(e.childNodes,t.recycleNode),o(e)),t.h=(e,t,n)=>"function"==typeof e?e(t||{},n):h(e,t||{},Array.isArray(n)?n:null==n?[]:[n],null==t?void 0:t.key),t.React={createElement:t.h},t.patch=(e,t,n,r)=>Array.isArray(t)?d(e,t,e instanceof window.SVGElement,n,r):l(e.parentNode,e,e,t)},141:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTreeWalker=void 0;const n=NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT;t.createTreeWalker=function(e,t){return(e.ownerDocument||document).createTreeWalker(e,n,{acceptNode(e){if(e.nodeType===Node.TEXT_NODE&&""===e.nodeValue)return NodeFilter.FILTER_REJECT;if(t){const n=t(e);return n?!0===n?NodeFilter.FILTER_ACCEPT:n:NodeFilter.FILTER_REJECT}return NodeFilter.FILTER_ACCEPT}})}},5046:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.proxy=t.rootStore=t.focusStore=t.selectionStore=t.docStore=t.activeStore=t.editorStores=void 0;const o=n(5120),i=r(n(7415)),s=r(n(9419)),a=()=>{},c=o.readable({},a),u=o.readable(new i.default,a),l=o.readable(null,a),d=o.readable(void 0,a);function f(e){if(!e)return c;let t=e.getActive();return o.readable(t,(n=>{const r=()=>{const r=e.getActive();s.default(t,r)||n(t=r)};return e.on("changed",r),e.on("format",r),()=>{e.off("changed",r),e.off("format",r)}}))}function h(e){return e?o.readable(e.doc,(t=>{const n=()=>t(e.doc);return n(),e.on("changed",n),()=>e.off("changed",n)})):u}function p(e){return e?o.readable(e.doc.selection,(t=>{const n=()=>t(e.doc.selection);return n(),e.on("changed",n),()=>e.off("changed",n)})):l}function g(e){return o.derived(e,(e=>!!e))}function m(e){return e?o.readable(e._root,(t=>{const n=()=>t(e._root);return n(),e.on("root",n),()=>e.off("root",n)})):d}function y(e){const t="subscribe"in e?o.get(e):e,{set:n,subscribe:r}=o.writable(t);let i;function s(e){i&&i(),e&&(i=e.subscribe((e=>n(e))))}return"subscribe"in e&&s(e),{set:s,subscribe:r}}t.editorStores=function(e){const t=y(f(e)),n=y(h(e)),r=y(p(e)),o=y(m(e)),i=g(r);return{active:t,doc:n,selection:r,root:o,focus:i,updateEditor:function(i){i!==e&&(e=i,t.set(f(e)),n.set(h(e)),r.set(p(e)),o.set(m(e)))}}},t.activeStore=f,t.docStore=h,t.selectionStore=p,t.focusStore=g,t.rootStore=m,t.proxy=y},7577:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTypes=void 0,n(9613),n(5854),n(5970),t.defaultTypes={lines:["paragraph","header","list","blockquote","code-block","hr"],formats:["link","bold","italic","code"],embeds:["image","br"]}},5970:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.br=t.image=void 0;const r=n(930),o=n(1703);t.image=o.embed({name:"image",selector:"img",commands:e=>(t,n)=>e.insert({image:t,...n}),fromDom:e=>{const t={};return["src","alt","width","height"].forEach((n=>{if(!e.hasAttribute(n))return;const r=e.getAttribute(n);"src"===n&&(n="image"),t[n]=r})),t},render:e=>{const{image:t,...n}=e;return n.src=t,r.h("img",n)}}),t.br=o.embed({name:"br",selector:"br",commands:e=>()=>e.insert({br:!0}),render:()=>r.h("br")})},5854:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.link=t.code=t.italic=t.bold=void 0;const r=n(930),o=n(1703);t.bold=o.format({name:"bold",selector:"strong, b",styleSelector:'[style*="font-weight:bold"], [style*="font-weight: bold"]',commands:e=>()=>e.toggleTextFormat({bold:!0}),shortcuts:"Mod+B",render:(e,t)=>r.h("strong",null,t)}),t.italic=o.format({name:"italic",selector:"em, i",styleSelector:'[style*="font-style:italic"], [style*="font-style: italic"]',commands:e=>()=>e.toggleTextFormat({italic:!0}),shortcuts:"Mod+I",render:(e,t)=>r.h("em",null,t)}),t.code=o.format({name:"code",selector:"code",commands:e=>()=>e.toggleTextFormat({code:!0}),render:(e,t)=>r.h("code",null,t)}),t.link=o.format({name:"link",selector:"a[href]",greedy:!1,commands:e=>t=>e.toggleTextFormat({link:t}),fromDom:e=>e.href,render:(e,t)=>r.h("a",{href:e.link,target:"_blank"},t)})},9613:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hr=t.codeblock=t.blockquote=t.list=t.header=t.paragraph=void 0;const r=n(930),o=n(1703),i=n(3797),s=n(8374);t.paragraph=o.line({name:"paragraph",selector:"p",commands:e=>()=>e.formatLine({}),shortcuts:"Mod+0",render:(e,t)=>r.h("p",null,t)}),t.header=o.line({name:"header",selector:"h1, h2, h3, h4, h5, h6",defaultFollows:!0,commands:e=>({header:t=>e.toggleLineFormat({header:t}),header1:()=>e.toggleLineFormat({header:1}),header2:()=>e.toggleLineFormat({header:2}),header3:()=>e.toggleLineFormat({header:3}),header4:()=>e.toggleLineFormat({header:4}),header5:()=>e.toggleLineFormat({header:5}),header6:()=>e.toggleLineFormat({header:6})}),shortcuts:{"Mod+1":"header1","Mod+2":"header2","Mod+3":"header3","Mod+4":"header4","Mod+5":"header5","Mod+6":"header6"},fromDom:e=>({header:parseInt(e.nodeName.replace("H",""))}),render:(e,t)=>r.h(`h${e.header}`,null,t)}),t.list=o.line({name:"list",selector:"ul > li, ol > li",indentable:!0,commands:e=>({bulletList:()=>e.toggleLineFormat({list:"bullet"}),orderedList:()=>e.toggleLineFormat({list:"ordered"}),checkList:()=>e.toggleLineFormat({list:"check"}),indent:()=>e.indent(),outdent:()=>e.outdent(),toggleCheck:t=>{const n="string"==typeof t?e.doc.byId[t]:e.doc.selection?e.doc.getLineAt(e.doc.selection[0]):null;if(!n)return!1;const[r]=e.doc.getLineRange(n),o={list:"check"};n.attributes.checked||(o.checked=!0),e.formatLine(o,r)}}),shortcuts:{"Mod+Space":"toggleCheck"},fromDom(e){let t=-1,n=e.parentNode;const r=e.hasAttribute("data-checked")?"check":n&&"OL"===n.nodeName?"ordered":"bullet";for(;n;){if(/^UL|OL$/.test(n.nodeName))t++;else if("LI"!==n.nodeName)break;n=n.parentNode}!t&&e.className.startsWith("ql-indent-")&&(t=parseInt(e.className.replace("ql-indent-","")));const o={list:r};return t&&(o.indent=t),"true"===e.getAttribute("data-checked")&&(o.checked=!0),o},nextLineAttributes(e){const{start:t,...n}=e;return n},shouldCombine:(e,t)=>e.list===t.list||t.indent,renderMultiple:(e,t)=>{const n=[],o=[];return e.forEach((([e,s])=>{const a="ordered"===e.list?"ol":"ul",c=e.indent||0;let u={key:e.id};if("check"===e.list){function l(n){t.enabled&&(n.preventDefault(),t.commands.toggleCheck(e.id))}const n=r.h("button",{class:"check-list-check",onmousedown:l,ontouchstart:l});1===s.length&&"br"===s[0].type?s.push(n):s.unshift(n),u={...u,class:"check-list-item","data-checked":""+(e.checked||!1)}}const d=i.applyDecorations(r.h("li",u,s),e);for(;c>=o.length;){const t=r.h(a,{start:e.start,type:e.type}),i=o.length?o[o.length-1].children:n,s=i[i.length-1];"object"==typeof s&&"li"===s.type?s.children.push(t):i.push(t),o.push(t)}if(!function(e,t,n){return e.type===t&&(e.props.start===n.start||e.props.start&&!n.start)&&e.props.type===n.type}(o[c],a,e)){const t=r.h(a,{start:e.start,type:e.type});(c?o[c-1].children:n).push(t),o[c]=t}o[c].children.push(d),o.length=c+1})),n[0]}}),t.blockquote=o.line({name:"blockquote",selector:"blockquote p",commands:e=>(t=!0)=>{"string"!=typeof t&&(t=!0),e.toggleLineFormat({blockquote:t})},fromDom(e){const{className:t}=e.parentNode,n=t.match(/quote-(\S+)/);return{blockquote:n&&"true"!==n[1]&&n[1]||!0}},shouldCombine:(e,t)=>e.blockquote===t.blockquote,renderMultiple:e=>{const t=e[0][0].blockquote,n="string"==typeof t?{className:`quote-${t}`}:null,o=e.map((([e,t])=>r.h("p",{key:e.id},t)));return r.h("blockquote",n,o)}}),t.codeblock=o.line({name:"code-block",selector:"pre code",contained:!0,commands:e=>()=>e.toggleLineFormat({"code-block":!0}),renderMultiple:e=>{const t=[];return e.forEach((([e,n])=>{n.length&&"br"===n[n.length-1].type&&n.pop(),t.push(r.h("code",{key:e.id},n)),t.push("\n")})),r.h("pre",{spellcheck:!1},t)}}),t.hr=o.line({name:"hr",selector:"hr",frozen:!0,commands:e=>()=>{const{doc:t}=e,{selection:n}=t;if(!n)return;const r=s.normalizeRange(n),o=e.change.delete(r);r[0]===r[1]&&1===t.getLineAt(r[0]).length?(o.formatLine(r[0],{hr:!0}),o.select(r[0]+1)):(o.insert(r[0],"\n",{hr:!0}),o.select(r[0]+2)),e.update(o)},render:()=>r.h("hr")})},1703:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Types=t.embed=t.format=t.line=t.Typeset=void 0;const n=[],r={},o={},i={},s=(e,t)=>!0;class a{constructor(e){var t,s,a;const c=null===(t=e.lines)||void 0===t?void 0:t.map((e=>"string"==typeof e?r[e]:e)).filter(Boolean),u=null===(s=e.formats)||void 0===s?void 0:s.map((e=>"string"==typeof e?o[e]:e)).filter(Boolean),l=null===(a=e.embeds)||void 0===a?void 0:a.map((e=>"string"==typeof e?i[e]:e)).filter(Boolean);this.lines=new d(c||n),this.formats=new d(u||n),this.embeds=new d(l||n)}}function c(e){return e.renderMultiple&&!e.shouldCombine&&(e.shouldCombine=s),r[e.name]=e}function u(e){return o[e.name]=e}function l(e){return i[e.name]=e}t.Typeset=a,a.line=c,a.format=u,a.embed=l,t.line=c,t.format=u,t.embed=l;class d{constructor(e){this.list=e,this.init()}get default(){return this.list[0]}init(){this.selector=this.list.map((e=>e.selector||"")).filter(Boolean).join(", "),this.types=this.list.reduce(((e,t)=>(e[t.name]=t,e)),{}),this.priorities=this.list.reduce(((e,t,n)=>(e[t.name]=n,e)),{})}add(e){this.list.push(e),this.init()}get(e){return this.types[e]}priority(e){return this.priorities[e]}matches(e){if(!e)return!1;if(!e.nodeType)throw new Error("Cannot match against "+e);return e.nodeType===Node.ELEMENT_NODE?!!this.selector&&e.matches(this.selector):void 0}findByNode(e,t=!1){if(e.nodeType!==Node.ELEMENT_NODE)return;let n=this.list.length;for(;n--;){let t=this.list[n];if(e.matches(t.selector))return t}return t?this.default:void 0}findByAttributes(e,t=!1){const n=e&&Object.keys(e);let r;return n&&n.every((e=>!(r=this.get(e)))),r||(t?this.default:void 0)}}t.Types=d},7506:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=new WeakMap,r=new WeakMap;function o(e,t,r=!1){let o=n.get(e);return!o&&r&&n.set(e,o=Object.create(null)),o&&o[t]||r&&(o[t]=new Set)}function i(e,t,i,s=!1){let a=r.get(e);!a&&s&&n.set(e,a=Object.create(null));const c=a&&a[t]||s&&(a[t]=new Map);if(!c.has(i)&&s){const n=n=>{const r=o(e,t);r&&r.delete(i),i.call(e,n)};c.set(i,n)}return c&&c.get(i)}t.default=class{on(e,t,n){this.addEventListener(e,t,n)}off(e,t,n){this.removeEventListener(e,t,n)}addEventListener(e,t,n){(null==n?void 0:n.once)&&(t=i(this,e,t,!0)),o(this,e,!0).add(t)}removeEventListener(e,t,n){if((null==n?void 0:n.once)&&(t=i(this,e,t)),!t)return;const r=o(this,e);r&&r.delete(t)}dispatchEvent(e){let t=!0;const n=o(this,e.type);n&&n.forEach((n=>{t&&n.call(this,e),e.cancelBubble&&(t=!1)}))}}},6098:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){if(!t)return t;if("function"==typeof t.toJSON&&(t=t.toJSON()),Array.isArray(t))return t.map(e);if("object"==typeof t){const n={};return Object.keys(t).forEach((r=>n[r]=e(t[r]))),n}return t}},4154:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n={};return Object.keys(e).forEach((r=>{e[r]===t[r]&&(n[r]=e[r])})),n}},9419:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={},r=()=>!1;function o(e,t){return e===t}t.default=function e(t,i,s=n){if(t===i)return!0;const a=typeof t,c=typeof t;if("number"===a&&"number"===c&&isNaN(t)&&isNaN(i))return!0;if(!t||!i||"object"!==a||"object"!==c||t.constructor!==i.constructor)return!1;if(t.valueOf()!==t)return e(t.valueOf(),i.valueOf(),s);const u=s.shallow?o:e;if("function"==typeof t[Symbol.iterator]){const e=t[Symbol.iterator](),n=i[Symbol.iterator]();let r=e.next(),o=n.next();for(;!r.done&&!o.done;){if(!u(r.value,o.value,s))return!1;r=e.next(),o=n.next()}return r.done===o.done}const l=s.excludeProps?s.excludeProps.has.bind(s.excludeProps):r,d=Object.keys(t),f=Object.keys(i);return(s.partial||d.length===f.length)&&f.every((e=>l(e)||t.hasOwnProperty(e)&&u(i[e],t[e],s)))}}},t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=n(1379),t=n(5120);const r={},o={};function i(e){return{...e.location,state:e.history.state,key:e.history.state&&e.history.state.key||"initial"}}const s=function(e,t){const n=[];let r=i(e);return{get location(){return r},listen(t){n.push(t);const o=()=>{r=i(e),t({location:r,action:"POP"})};return e.addEventListener("popstate",o),()=>{e.removeEventListener("popstate",o);const r=n.indexOf(t);n.splice(r,1)}},navigate(t,{state:o,replace:s=!1}={}){o={...o,key:Date.now()+""};try{s?e.history.replaceState(o,null,t):e.history.pushState(o,null,t)}catch(n){e.location[s?"replace":"assign"](t)}r=i(e),n.forEach((e=>e({location:r,action:"PUSH"})))}}}(Boolean("undefined"!=typeof window&&window.document&&window.document.createElement)?window:function(e="/"){let t=0;const n=[{pathname:e,search:""}],r=[];return{get location(){return n[t]},addEventListener(e,t){},removeEventListener(e,t){},history:{get entries(){return n},get index(){return t},get state(){return r[t]},pushState(e,o,i){const[s,a=""]=i.split("?");t++,n.push({pathname:s,search:a}),r.push(e)},replaceState(e,o,i){const[s,a=""]=i.split("?");n[t]={pathname:s,search:a},r[t]=e}}}}()),{navigate:a}=s,c=/^:(.+)/;function u(e){return"*"===e[0]}function l(e){return e.replace(/(^\/+|\/+$)/g,"").split("/")}function d(e){return e.replace(/(^\/+|\/+$)/g,"")}function f(e,t){return{route:e,score:e.default?0:l(e.path).reduce(((e,t)=>(e+=4,function(e){return""===e}(t)?e+=1:function(e){return c.test(e)}(t)?e+=2:u(t)?e-=5:e+=3,e)),0),index:t}}function h(e,t){let n,r;const[o]=t.split("?"),i=l(o),s=""===i[0],a=function(e){return e.map(f).sort(((e,t)=>e.score<t.score?1:e.score>t.score?-1:e.index-t.index))}(e);for(let e=0,o=a.length;e<o;e++){const o=a[e].route;let d=!1;if(o.default){r={route:o,params:{},uri:t};continue}const f=l(o.path),h={},p=Math.max(i.length,f.length);let g=0;for(;g<p;g++){const e=f[g],t=i[g];if(void 0!==e&&u(e)){h["*"===e?"*":e.slice(1)]=i.slice(g).map(decodeURIComponent).join("/");break}if(void 0===t){d=!0;break}let n=c.exec(e);if(n&&!s){const e=decodeURIComponent(t);h[n[1]]=e}else if(e!==t){d=!0;break}}if(!d){n={route:o,params:h,uri:"/"+i.slice(0,g).join("/")};break}}return n||r||null}function p(e,t){return`${d("/"===t?e:`${d(e)}/${d(t)}`)}/`}function g(t){let n;const r=t[9].default,o=(0,e.nu)(r,t,t[8],null);return{c(){o&&o.c()},m(e,t){o&&o.m(e,t),n=!0},p(t,[n]){o&&o.p&&256&n&&(0,e.Tj)(o,r,t,t[8],n,null,null)},i(t){n||((0,e.Ui)(o,t),n=!0)},o(t){(0,e.et)(o,t),n=!1},d(e){o&&o.d(e)}}}function m(n,i,a){let c,u,l,{$$slots:d={},$$scope:f}=i,{basepath:g="/"}=i,{url:m=null}=i;const y=(0,e.fw)(r),b=(0,e.fw)(o),v=(0,t.writable)([]);(0,e.FI)(n,v,(e=>a(7,l=e)));const w=(0,t.writable)(null);let _=!1;const E=y||(0,t.writable)(m?{pathname:m}:s.location);(0,e.FI)(n,E,(e=>a(6,u=e)));const x=b?b.routerBase:(0,t.writable)({path:g,uri:g});(0,e.FI)(n,x,(e=>a(5,c=e)));const k=(0,t.derived)([x,w],(([e,t])=>{if(null===t)return e;const{path:n}=e,{route:r,uri:o}=t;return{path:r.default?n:r.path.replace(/\*.*$/,""),uri:o}}));return y||((0,e.H3)((()=>s.listen((e=>{E.set(e.location)})))),(0,e.v)(r,E)),(0,e.v)(o,{activeRoute:w,base:x,routerBase:k,registerRoute:function(e){const{path:t}=c;let{path:n}=e;if(e._path=n,e.path=p(t,n),"undefined"==typeof window){if(_)return;const t=function(e,t){return h([e],t)}(e,u.pathname);t&&(w.set(t),_=!0)}else v.update((t=>(t.push(e),t)))},unregisterRoute:function(e){v.update((t=>{const n=t.indexOf(e);return t.splice(n,1),t}))}}),n.$$set=e=>{"basepath"in e&&a(3,g=e.basepath),"url"in e&&a(4,m=e.url),"$$scope"in e&&a(8,f=e.$$scope)},n.$$.update=()=>{if(32&n.$$.dirty){const{path:e}=c;v.update((t=>(t.forEach((t=>t.path=p(e,t._path))),t)))}if(192&n.$$.dirty){const e=h(l,u.pathname);w.set(e)}},[v,E,x,g,m,c,u,l,f,d]}class y extends e.f_{constructor(t){super(),(0,e.S1)(this,t,m,g,e.N8,{basepath:3,url:4})}}const b=y,v=e=>({params:4&e,location:16&e}),w=e=>({params:e[2],location:e[4]});function _(t){let n,r,o,i;const s=[x,E],a=[];function c(e,t){return null!==e[0]?0:1}return n=c(t),r=a[n]=s[n](t),{c(){r.c(),o=(0,e.cS)()},m(t,r){a[n].m(t,r),(0,e.$T)(t,o,r),i=!0},p(t,i){let u=n;n=c(t),n===u?a[n].p(t,i):((0,e.dv)(),(0,e.et)(a[u],1,1,(()=>{a[u]=null})),(0,e.gb)(),r=a[n],r?r.p(t,i):(r=a[n]=s[n](t),r.c()),(0,e.Ui)(r,1),r.m(o.parentNode,o))},i(t){i||((0,e.Ui)(r),i=!0)},o(t){(0,e.et)(r),i=!1},d(t){a[n].d(t),t&&(0,e.og)(o)}}}function E(t){let n;const r=t[10].default,o=(0,e.nu)(r,t,t[9],w);return{c(){o&&o.c()},m(e,t){o&&o.m(e,t),n=!0},p(t,n){o&&o.p&&532&n&&(0,e.Tj)(o,r,t,t[9],n,v,w)},i(t){n||((0,e.Ui)(o,t),n=!0)},o(t){(0,e.et)(o,t),n=!1},d(e){o&&o.d(e)}}}function x(t){let n,r,o;const i=[{location:t[4]},t[2],t[3]];var s=t[0];function a(t){let n={};for(let t=0;t<i.length;t+=1)n=(0,e.f0)(n,i[t]);return{props:n}}return s&&(n=new s(a())),{c(){n&&(0,e.YC)(n.$$.fragment),r=(0,e.cS)()},m(t,i){n&&(0,e.ye)(n,t,i),(0,e.$T)(t,r,i),o=!0},p(t,o){const c=28&o?(0,e.Lo)(i,[16&o&&{location:t[4]},4&o&&(0,e.gC)(t[2]),8&o&&(0,e.gC)(t[3])]):{};if(s!==(s=t[0])){if(n){(0,e.dv)();const t=n;(0,e.et)(t.$$.fragment,1,0,(()=>{(0,e.vp)(t,1)})),(0,e.gb)()}s?(n=new s(a()),(0,e.YC)(n.$$.fragment),(0,e.Ui)(n.$$.fragment,1),(0,e.ye)(n,r.parentNode,r)):n=null}else s&&n.$set(c)},i(t){o||(n&&(0,e.Ui)(n.$$.fragment,t),o=!0)},o(t){n&&(0,e.et)(n.$$.fragment,t),o=!1},d(t){t&&(0,e.og)(r),n&&(0,e.vp)(n,t)}}}function k(t){let n,r,o=null!==t[1]&&t[1].route===t[7]&&_(t);return{c(){o&&o.c(),n=(0,e.cS)()},m(t,i){o&&o.m(t,i),(0,e.$T)(t,n,i),r=!0},p(t,[r]){null!==t[1]&&t[1].route===t[7]?o?(o.p(t,r),2&r&&(0,e.Ui)(o,1)):(o=_(t),o.c(),(0,e.Ui)(o,1),o.m(n.parentNode,n)):o&&((0,e.dv)(),(0,e.et)(o,1,1,(()=>{o=null})),(0,e.gb)())},i(t){r||((0,e.Ui)(o),r=!0)},o(t){(0,e.et)(o),r=!1},d(t){o&&o.d(t),t&&(0,e.og)(n)}}}function O(t,n,i){let s,a,{$$slots:c={},$$scope:u}=n,{path:l=""}=n,{component:d=null}=n;const{registerRoute:f,unregisterRoute:h,activeRoute:p}=(0,e.fw)(o);(0,e.FI)(t,p,(e=>i(1,s=e)));const g=(0,e.fw)(r);(0,e.FI)(t,g,(e=>i(4,a=e)));const m={path:l,default:""===l};let y={},b={};return f(m),"undefined"!=typeof window&&(0,e.ev)((()=>{h(m)})),t.$$set=t=>{i(13,n=(0,e.f0)((0,e.f0)({},n),(0,e.Jv)(t))),"path"in t&&i(8,l=t.path),"component"in t&&i(0,d=t.component),"$$scope"in t&&i(9,u=t.$$scope)},t.$$.update=()=>{2&t.$$.dirty&&s&&s.route===m&&i(2,y=s.params);{const{path:e,component:t,...r}=n;i(3,b=r)}},n=(0,e.Jv)(n),[d,s,y,b,a,p,g,m,l,u,c]}class S extends e.f_{constructor(t){super(),(0,e.S1)(this,t,O,k,e.N8,{path:8,component:0})}}const T=S;var L=n(5832);function C(t){return(0,e.H3)((async()=>{L.oauth2.authorize({clientId:"dips-ehr-notes",scope:"launch launch/patient patient/*.write patient/read offline_access openid fhirUser",redirectUri:"./app",iss:"https://launch.smarthealthit.org/v/r3/sim/eyJoIjoiMSIsImIiOiJmMDQ2MjkzNi1lYjRiLTRkYTEtYjQ1YS1mYmQ5NmViZjhjY2IiLCJlIjoic21hcnQtUHJhY3RpdGlvbmVyLTcxNjE0NTAyIn0/fhir"})})),[]}class A extends e.f_{constructor(t){super(),(0,e.S1)(this,t,C,null,e.N8,{})}}const j=A,P=(0,t.writable)(null);function R(e,t,n){const r=e.slice();return r[2]=t[n],r[4]=n,r}function F(t){let n,r,o=t[0]?.name[0].family+"",i=t[0]?.name[0].given,s=[];for(let e=0;e<i.length;e+=1)s[e]=N(R(t,i,e));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();n=(0,e.Dh)(),r=(0,e.fL)(o)},m(t,o){for(let e=0;e<s.length;e+=1)s[e].m(t,o);(0,e.$T)(t,n,o),(0,e.$T)(t,r,o)},p(t,a){if(1&a){let e;for(i=t[0]?.name[0].given,e=0;e<i.length;e+=1){const r=R(t,i,e);s[e]?s[e].p(r,a):(s[e]=N(r),s[e].c(),s[e].m(n.parentNode,n))}for(;e<s.length;e+=1)s[e].d(1);s.length=i.length}1&a&&o!==(o=t[0]?.name[0].family+"")&&(0,e.rT)(r,o)},d(t){(0,e.RM)(s,t),t&&(0,e.og)(n),t&&(0,e.og)(r)}}}function N(t){let n,r=t[2]+"";return{c(){n=(0,e.fL)(r)},m(t,r){(0,e.$T)(t,n,r)},p(t,o){1&o&&r!==(r=t[2]+"")&&(0,e.rT)(n,r)},d(t){t&&(0,e.og)(n)}}}function $(t){let n,r=null!=t[0]&&F(t);return{c(){n=(0,e.bG)("p"),r&&r.c()},m(t,o){(0,e.$T)(t,n,o),r&&r.m(n,null)},p(e,[t]){null!=e[0]?r?r.p(e,t):(r=F(e),r.c(),r.m(n,null)):r&&(r.d(1),r=null)},i:e.ZT,o:e.ZT,d(t){t&&(0,e.og)(n),r&&r.d()}}}function M(t,n,r){let o;(0,e.FI)(t,P,(e=>r(1,o=e)));let i=null;return t.$$.update=()=>{2&t.$$.dirty&&o?.client?.patient.read().then((e=>r(0,i=e)))},[i,o]}L.oauth2.ready().then((e=>{console.log("client loaded");var t={client:e,error:null};P.update((e=>t))})).catch((e=>{var t={client:null,error:e};P.update((e=>t))}));class D extends e.f_{constructor(t){super(),(0,e.S1)(this,t,M,$,e.N8,{})}}const I=D;var U=n(3413),B=n(8173);function z(t){let n,r;const o=t[4].default,i=(0,e.nu)(o,t,t[3],null);return{c(){n=(0,e.bG)("div"),i&&i.c(),(0,e.Lj)(n,"class",t[0])},m(o,s){(0,e.$T)(o,n,s),i&&i.m(n,null),t[5](n),r=!0},p(t,[s]){i&&i.p&&8&s&&(0,e.Tj)(i,o,t,t[3],s,null,null),(!r||1&s)&&(0,e.Lj)(n,"class",t[0])},i(t){r||((0,e.Ui)(i,t),r=!0)},o(t){(0,e.et)(i,t),r=!1},d(r){r&&(0,e.og)(n),i&&i.d(r),t[5](null)}}}function q(t,n,r){let o,i,{$$slots:s={},$$scope:a}=n,{editor:c}=n,{class:u}=n;return(0,e.H3)((()=>{const e=Array.from(o.childNodes);return c&&o.children.length&&c.set((0,B.docFromDom)(c,o)),()=>{for(let t=0;t<e.length;t++)o.appendChild(e[t])}})),t.$$set=e=>{"editor"in e&&r(2,c=e.editor),"class"in e&&r(0,u=e.class),"$$scope"in e&&r(3,a=e.$$scope)},t.$$.update=()=>{6&t.$$.dirty&&function(e,t){t&&(i&&i.destroy(),i=e,e&&e.setRoot(t))}(c,o)},[u,o,c,a,s,function(t){e.Vn[t?"unshift":"push"]((()=>{o=t,r(1,o)}))}]}class H extends e.f_{constructor(t){super(),(0,e.S1)(this,t,q,z,e.N8,{editor:2,class:0})}}const Y=H;function W(t){let n,r,o;return{c(){n=(0,e.bG)("h1"),n.textContent="Daglig notat",r=(0,e.Dh)(),o=(0,e.bG)("p")},m(t,i){(0,e.$T)(t,n,i),(0,e.$T)(t,r,i),(0,e.$T)(t,o,i)},d(t){t&&(0,e.og)(n),t&&(0,e.og)(r),t&&(0,e.og)(o)}}}function V(t){let n,r;return n=new Y({props:{editor:t[0],class:"text-content",$$slots:{default:[W]},$$scope:{ctx:t}}}),{c(){(0,e.YC)(n.$$.fragment)},m(t,o){(0,e.ye)(n,t,o),r=!0},p(e,[t]){const r={};2&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(t){r||((0,e.Ui)(n.$$.fragment,t),r=!0)},o(t){(0,e.et)(n.$$.fragment,t),r=!1},d(t){(0,e.vp)(n,t)}}}function J(e){return[new U.Editor]}class K extends e.f_{constructor(t){super(),(0,e.S1)(this,t,J,V,e.N8,{})}}const Z=K;function G(t){let n,r,o,i;return n=new I({}),o=new Z({}),{c(){(0,e.YC)(n.$$.fragment),r=(0,e.Dh)(),(0,e.YC)(o.$$.fragment)},m(t,s){(0,e.ye)(n,t,s),(0,e.$T)(t,r,s),(0,e.ye)(o,t,s),i=!0},p:e.ZT,i(t){i||((0,e.Ui)(n.$$.fragment,t),(0,e.Ui)(o.$$.fragment,t),i=!0)},o(t){(0,e.et)(n.$$.fragment,t),(0,e.et)(o.$$.fragment,t),i=!1},d(t){(0,e.vp)(n,t),t&&(0,e.og)(r),(0,e.vp)(o,t)}}}function X(t){let n,r;return{c(){n=(0,e.bG)("p"),r=(0,e.fL)(t[0])},m(t,o){(0,e.$T)(t,n,o),(0,e.R3)(n,r)},p(t,n){1&n&&(0,e.rT)(r,t[0])},i:e.ZT,o:e.ZT,d(t){t&&(0,e.og)(n)}}}function Q(t){let n,r,o,i;const s=[X,G],a=[];function c(e,t){return null!=e[0]?0:1}return n=c(t),r=a[n]=s[n](t),{c(){r.c(),o=(0,e.cS)()},m(t,r){a[n].m(t,r),(0,e.$T)(t,o,r),i=!0},p(t,[i]){let u=n;n=c(t),n===u?a[n].p(t,i):((0,e.dv)(),(0,e.et)(a[u],1,1,(()=>{a[u]=null})),(0,e.gb)(),r=a[n],r?r.p(t,i):(r=a[n]=s[n](t),r.c()),(0,e.Ui)(r,1),r.m(o.parentNode,o))},i(t){i||((0,e.Ui)(r),i=!0)},o(t){(0,e.et)(r),i=!1},d(t){a[n].d(t),t&&(0,e.og)(o)}}}function ee(t,n,r){let o;(0,e.FI)(t,P,(e=>r(1,o=e)));let i=null;return t.$$.update=()=>{2&t.$$.dirty&&r(0,i=o?.error)},[i,o]}class te extends e.f_{constructor(t){super(),(0,e.S1)(this,t,ee,Q,e.N8,{})}}const ne=te;function re(t){let n,r,o,i;return n=new T({props:{path:"/",component:j}}),o=new T({props:{path:"app",component:ne}}),{c(){(0,e.YC)(n.$$.fragment),r=(0,e.Dh)(),(0,e.YC)(o.$$.fragment)},m(t,s){(0,e.ye)(n,t,s),(0,e.$T)(t,r,s),(0,e.ye)(o,t,s),i=!0},p:e.ZT,i(t){i||((0,e.Ui)(n.$$.fragment,t),(0,e.Ui)(o.$$.fragment,t),i=!0)},o(t){(0,e.et)(n.$$.fragment,t),(0,e.et)(o.$$.fragment,t),i=!1},d(t){(0,e.vp)(n,t),t&&(0,e.og)(r),(0,e.vp)(o,t)}}}function oe(t){let n,r;return n=new b({props:{url:t[0],$$slots:{default:[re]},$$scope:{ctx:t}}}),{c(){(0,e.YC)(n.$$.fragment)},m(t,o){(0,e.ye)(n,t,o),r=!0},p(e,[t]){const r={};1&t&&(r.url=e[0]),2&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(t){r||((0,e.Ui)(n.$$.fragment,t),r=!0)},o(t){(0,e.et)(n.$$.fragment,t),r=!1},d(t){(0,e.vp)(n,t)}}}function ie(e,t,n){let{url:r=""}=t;return e.$$set=e=>{"url"in e&&n(0,r=e.url)},[r]}class se extends e.f_{constructor(t){super(),(0,e.S1)(this,t,ie,oe,e.N8,{url:0})}}new se({target:document.body})})()})();